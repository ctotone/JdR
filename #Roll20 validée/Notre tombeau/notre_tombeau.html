<!-- ----------------- -->
<!-- Valeurs integrées -->
<!-- ----------------- -->
<input type="hidden" name="attr_total_aptitudes" value="12">
<input type="hidden" name="attr_delta_aptitudes" value="30">
<div style="display:none">
    <button type="action" name="act_echec_majeur">
</div>

<!-- --------------------- -->
<!-- Feuille de personnage -->
<!-- --------------------- -->
<div class="feuille">
    <div class="wrapper_feuille">
        <div class="feuille_titre">
            <!-- NOTRE TOMBEAU -->
             URBEX
        </div>
        <div class="feuille_citation">
            "Ceci est le combat du jour et de la nuit...
            <br>
            Je vois de la lumière noire." <span class="hugo">DERNIERS MOTS DE VICTOR HUGO, 22MAI 1885</span>
        </div>
        <div class="feuille_aptitude">
            <div class="wrapper_aptitude">
                <div class="aptitude_titre1"><button type="action" class="aptitudes" title="Afficher ou masquer la 
somme des aptitudes" name="act_somme_aptitudes" style="font-size: 29px;">APTITUDES</button></div>
                <div class="aptitude_titre2">ACTION</div>
                <div class="aptitude_titre3">NOMBRE DE DÉS À 4 OU +</div>
            </div>
            <div class="wrapper_aptitude" style="margin-top: 15px;">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_1" title="courir vite, longtemps, 
tout en évitant les obstacles">COURIR</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_courir" min="1" max="12" value="1"></div>
                <div class="aptitude_3">FACILE</div>
                <div class="aptitude_4">RÉUSSITE AUTOMATIQUE</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_2" title="résister aux chocs, aux maladies,
à l'humidité, aux coups">ENCAISSER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_encaisser" min="1" max="12" value="1"></div>
                <div class="aptitude_3">RELATIVEMENT FACILE</div>
                <div class="aptitude_4">1</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_3" title="grimper à une corde ou à des aspérités,
le long d'un mur, s'avancer sur une corniche">ESCALADER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_escalader" min="1" max="12" value="1"></div>
                <div class="aptitude_3">MOYENNE</div>
                <div class="aptitude_4">2</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_4" title="pousser ou soulever un objet, 
lancer un objet le plus loin 
possible, tirer sur une corde, 
porter une personne sur ses épaules">FORCER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_forcer" min="1" max="12" value="1"></div>
                <div class="aptitude_3">DIFFICILE</div>
                <div class="aptitude_4">3</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_5" title="être rapide, avoir des réflexes, 
prendre l'initiative">RÉAGIR</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_reagir" min="1" max="12" value="1"></div>
                <div class="aptitude_3">TRÉS DIFFICILE</div>
                <div class="aptitude_4">4</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_6" title="utiliser ses cinq sens">REMARQUER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_remarquer" min="1" max="12" value="1"></div>
                <div class="aptitude_3">IMPOSSIBLE</div>
                <div class="aptitude_4">ÉCHEC AUTOMATIQUE</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_7" title="commander, donner des ordres 
ou intimider (des êtres humains)">S'IMPOSER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_imposer" min="1" max="12" value="1"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_8" title="sauter au dessus d'un précipice, 
tomber de plusieurs mètres de haut 
et retomber sur ses pas">SAUTER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_sauter" min="1" max="12" value="1"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_9" title="crocheter une serrure, faire un 
noeud coulant, un garrot, pratiquer 
les premiers soins, posséder des 
connaissances pratiques">SAVOIR-FAIRE</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_savoir_faire" min="1" max="12" value="1"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_10" title="frapper au contact, 
utiliser une arme, 
esquiver un coup">SE BATTRE</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_se_battre" min="1" max="12" value="1"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_11" title="se montrer discret, 
être silencieux, 
contrôler ses émotions, 
garder son sang-froid">SE CALMER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_se_calmer" min="1" max="12" value="1"></div>
                
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1"><button type="action" class="aptitudes" name="act_roll_aptitude_12" title="toucher une cible à distance, 
lancer une corde pour qu'elle 
s'agrippe">VISER</button></div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_viser" min="1" max="12" value="1"></div>
            </div>            
        </div>
        <input type="hidden" class="affichage_aptitude" name="attr_affichage_aptitude" value="0">
        <div class="affichage_aptitude">Points d'Aptitudes : <input type="number" class="aptitudes" name="attr_total_aptitudes" style="cursor: default;color: var(--white);font-size: 16px;margin-top: -7px;"> / 42</div>
        <div class="relance"><button type="action" class="aptitudes" name="act_relancer_de" title="1 point d'Adrénaline permet de relancer un dés 
(n'importe lequel, n'importe quand) aprés un 
jet de dés raté (1 maximum par tour)">RELANCE <span style="font-size: 13px;margin-left: 3px;">(1 POINT)</span></button> 
        </div>
        <div class="relance_info">relance un dé</div>
        <div class="regain"><span title="1 point d'Adrénaline permet de regagner 
1 point de Vie  (1 maximum par tour)">REGAIN</span> <span style="font-size: 13px;margin-left: 3px;">(1 POINT)</span>
        </div><div class="regain_info">regagne 1 point de Vie</div>
        <div class="feuille_vie">
            <input type="number" class="vie_adrenaline" name="attr_hp" min="0" max="6" value="6">
        </div>
        <div class="feuille_vie_titre">
            VIE
        </div>
        <div class="feuille_adrenaline">
            <input type="number" class="vie_adrenaline" name="attr_adrenaline" min="1" max="6" value="1">
        </div>
        <div class="feuille_adrenaline_titre">
            ADRÉNALINE
        </div>
        <div class="feuille_arme">
            ARMES DE FORTUNE
        </div>
        <div class="feuille_arme_donnees">
            <div class="wrapper_armes" style="margin-top: 15px;">
                <input type="hidden" class="arme_d1" name="attr_affichage_d1"  value="0">
                <div class="armes_roll"><button type="action" class="roll_armes" name="act_roll_armes_1"></button></div>
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_1"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1"><input type="number" class="armes_d" name="attr_dgt_arme_1" min="0" max="4" value="0"></div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2"><input type="number" class="armes_d" name="attr_dgt_arme_1_relance" min="0" max="2" value="0"></div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <input type="hidden" class="arme_d2" name="attr_affichage_d2"  value="0">
                <div class="armes_roll"><button type="action" class="roll_armes" name="act_roll_armes_2"></button></div>
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_2"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1"><input type="number" class="armes_d" name="attr_dgt_arme_2" min="0" max="4" value="0"></div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2"><input type="number" class="armes_d" name="attr_dgt_arme_2_relance" min="0" max="2" value="0"></div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <input type="hidden" class="arme_d3" name="attr_affichage_d3"  value="0">
                <div class="armes_roll"><button type="action" class="roll_armes" name="act_roll_armes_3"></button></div>
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_3"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1"><input type="number" class="armes_d" name="attr_dgt_arme_3" min="0" max="4" value="0"></div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2"><input type="number" class="armes_d" name="attr_dgt_arme_3_relance" min="0" max="2" value="0"></div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <input type="hidden" class="arme_d4" name="attr_affichage_d4"  value="0">
                <div class="armes_roll"><button type="action" class="roll_armes" name="act_roll_armes_4"></button></div>
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_4"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1"><input type="number" class="armes_d" name="attr_dgt_arme_4" min="0" max="4" value="0"></div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2"><input type="number" class="armes_d" name="attr_dgt_arme_4_relance" min="0" max="2" value="0"></div>
                <div class="armes_fixe3">D)</div>
            </div>
        </div>
        <div class="feuille_sauvagerie">
            SAUVAGERIE
        </div>
        <div class="feuille_sauvagerie_donnees">
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_CARNAGE" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=CARNAGE (2 POINTS)}}{{desc=L'arme utilisée inflige \les dommages maximums}}">CARNAGE (2 POINTS)</button></div>
                <div class="sauvagerie_info">inflige les dommages maximum.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_FRÉNÉSIE" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=FRÉNÉSIE (2 POINTS)}}{{desc=Permet d'effectuer deux actions consécutives sans pouvoir être contré}}">FRÉNÉSIE (2 POINTS)</button></div>
                <div class="sauvagerie_info">deux actions consécutives sans contre.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_INSENSIBILITÉ" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=INSENSIBILITÉ (3 POINTS)}}{{desc=Permet d'ignorer la dernière perte de point de vie}}">INSENSIBILITÉ (3 POINTS)</button></div>
                <div class="sauvagerie_info">ignore la dernière perte de points de Vie.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_FURIE" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=FURIE (3 POINTS)}}{{desc=Permet d'ajouter deux dés d'aptitude \à sa prochaine action}}">FURIE (3 POINTS)</button></div>
                <div class="sauvagerie_info">deux dés supplémentaires à la prochaine action</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_MISE_À_MORT" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=MISE À MORT (4 POINTS)}}{{desc=Tue du premier coup (ou rend KO) \nla cible touchée}}">MISE À MORT (4 POINTS)</button></div>
                <div class="sauvagerie_info">tue du premier coup ou met KO.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom"><button type="roll" class="aptitudes" name="roll_INVULNÉRABILITÉ" title="Afficher le descriptif dans 
la fenètre de discussion" style="font-size:14px;margin-left: -5px;color: var(--black);" value="&{template:tombeau} {{sauvagerie=oui}} {{title=INVULNÉRABILITÉ (X PONTS)}}{{desc=Permet de regagner autant de Vie que d'Adrénaline dépensés}}">INVULNÉRABILITÉ (X PONTS)</button></div>
                <div class="sauvagerie_info">regagne autant de Vie que de points d'Adrénaline dépensés.</div> 
            </div>
        </div>
    </div>
</div>

<!-- -------------------- -->
<!-- ----- SCRIPT ------- -->
<!-- -------------------- -->

<!-- Script Roll aptitudes -->
<script type="text/worker">
    const roll_aptitude_Values = ["1","2","3","4","5","6","7","8","9","10","11","12"];
    roll_aptitude_Values.forEach(function(value) {
    on(`clicked:roll_aptitude_${value}`, (info) => {
        startRoll("&{template:aptitude} {{aptitude=oui}} {{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d5=[[d6]]}} {{d6=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d5bis=[[d6 (Relance du D5)]]}} {{d6bis=[[d6 (Relance du D6)]]}} {{d1ter=[[d6 (Relance du D1bis)]]}} {{d2ter=[[d6 (Relance du D2bis)]]}} {{d3ter=[[d6 (Relance du D3bis)]]}} {{d4ter=[[d6 (Relance du D4bis)]]}}  {{d5ter=[[d6 (Relance du D5bis)]]}} {{d6ter=[[d6 (Relance du D6bis)]]}} {{d1quat=[[d6 (Relance du D1ter)]]}} {{d2quat=[[d6 (Relance du D2ter)]]}} {{d3quat=[[d6 (Relance du D3ter)]]}} {{d4quat=[[d6 (Relance du D4ter)]]}} {{d5quat=[[d6 (Relance du D5ter)]]}} {{d6quat=[[d6 (Relance du D6ter)]]}} {{d7=[[d6]]}} {{d8=[[d6]]}} {{d9=[[d6]]}} {{d10=[[d6]]}} {{d11=[[d6]]}} {{d12=[[d6]]}} {{d7bis=[[d6 (Relance du D7)]]}} {{d8bis=[[d6 (Relance du D8)]]}} {{d9bis=[[d6 (Relance du D9)]]}} {{d10bis=[[d6 (Relance du D10)]]}} {{d11bis=[[d6 (Relance du D11)]]}} {{d12bis=[[d6 (Relance du D12)]]}} {{d7ter=[[d6 (Relance du D7bis)]]}} {{d8ter=[[d6 (Relance du D8bis)]]}} {{d9ter=[[d6 (Relance du D9bis)]]}} {{d10ter=[[d6 (Relance du D10bis)]]}}  {{d11ter=[[d6 (Relance du D11bis)]]}} {{d12ter=[[d6 (Relance du D12bis)]]}} {{d7quat=[[d6 (Relance du D7ter)]]}} {{d8quat=[[d6 (Relance du D8ter)]]}} {{d9quat=[[d6 (Relance du D9ter)]]}} {{d10quat=[[d6 (Relance du D10ter)]]}} {{d11quat=[[d6 (Relance du D11ter)]]}} {{d12quat=[[d6 (Relance du D12ter)]]}} {{courir=[[@{courir}]]}} {{encaisser=[[@{encaisser}]]}} {{escalader=[[@{escalader}]]}} {{forcer=[[@{forcer}]]}} {{reagir=[[@{reagir}]]}} {{remarquer=[[@{remarquer}]]}} {{imposer=[[@{imposer}]]}} {{sauter=[[@{sauter}]]}} {{savoir_faire=[[@{savoir_faire}]]}} {{se_battre=[[@{se_battre}]]}} {{se_calmer=[[@{se_calmer}]]}} {{viser=[[@{viser}]]}} {{difficulte=[[?{Difficulté de l'action|2|1|3|4} -1]]}} {{difficulte_reel=[[?{Difficulté de l'action|2|1|3|4}]]}} {{reussite=[[0[resultat]]]}} {{relance=[[0[resultat]]]}} {{nombre_de=[[0[resultat]]]}} {{titre=[[0[resultat]]]}} {{marge=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let d5 = parseInt(results.results.d5.dice);
            let d6 = parseInt(results.results.d6.dice);
            let d7     = parseInt(results.results.d7.dice);
            let d8     = parseInt(results.results.d8.dice);
            let d9     = parseInt(results.results.d9.dice);
            let d10    = parseInt(results.results.d10.dice);
            let d11    = parseInt(results.results.d11.dice);
            let d12    = parseInt(results.results.d12.dice);
            let courir = parseInt(results.results.courir.result);
            let encaisser = parseInt(results.results.encaisser.result);
            let escalader = parseInt(results.results.escalader.result);
            let reagir = parseInt(results.results.reagir.result);
            let remarquer = parseInt(results.results.remarquer.result);
            let imposer = parseInt(results.results.imposer.result);
            let savoir_faire = parseInt(results.results.savoir_faire.result);
            let se_battre = parseInt(results.results.se_battre.result);
            let se_calmer = parseInt(results.results.se_calmer.result);
            let viser = parseInt(results.results.viser.result);
            let forcer = parseInt(results.results.forcer.result);
            let sauter = parseInt(results.results.sauter.result);
            let difficulte = parseInt(results.results.difficulte.result);
            let nombre_de = 0;
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let reussite_5 = 0;
            let reussite_6 = 0;
            let reussite_7  = 0;
            let reussite_8  = 0;
            let reussite_9  = 0;
            let reussite_10 = 0;
            let reussite_11 = 0;
            let reussite_12 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let computed_d5 = 0;
            let computed_d6 = 0;
            let computed_d7  = 0;
            let computed_d8  = 0;
            let computed_d9  = 0;
            let computed_d10 = 0;
            let computed_d11 = 0;
            let computed_d12 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let d5bis = parseInt(results.results.d5bis.dice);
            let d6bis = parseInt(results.results.d6bis.dice);
            let d7bis  = parseInt(results.results.d7bis.dice);
            let d8bis  = parseInt(results.results.d8bis.dice);
            let d9bis  = parseInt(results.results.d9bis.dice);
            let d10bis = parseInt(results.results.d10bis.dice);
            let d11bis = parseInt(results.results.d11bis.dice);
            let d12bis = parseInt(results.results.d12bis.dice);
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let computed_d5bis = 0;
            let computed_d6bis = 0;
            let computed_d7bis  = 0;
            let computed_d8bis  = 0;
            let computed_d9bis  = 0;
            let computed_d10bis = 0;
            let computed_d11bis = 0;
            let computed_d12bis = 0;
            
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let reussite_5bis = 0;
            let reussite_6bis = 0;
            let reussite_7bis  = 0;
            let reussite_8bis  = 0;
            let reussite_9bis  = 0;
            let reussite_10bis = 0;
            let reussite_11bis = 0;
            let reussite_12bis = 0;
            let d1ter = parseInt(results.results.d1ter.dice);
            let d2ter = parseInt(results.results.d2ter.dice);
            let d3ter = parseInt(results.results.d3ter.dice);
            let d4ter = parseInt(results.results.d4ter.dice);
            let d5ter = parseInt(results.results.d5ter.dice);
            let d6ter = parseInt(results.results.d6ter.dice);
            let d7ter  = parseInt(results.results.d7ter.dice);
            let d8ter  = parseInt(results.results.d8ter.dice);
            let d9ter  = parseInt(results.results.d9ter.dice);
            let d10ter = parseInt(results.results.d10ter.dice);
            let d11ter = parseInt(results.results.d11ter.dice);
            let d12ter = parseInt(results.results.d12ter.dice);
            let computed_d1ter = 0;
            let computed_d2ter = 0;
            let computed_d3ter = 0;
            let computed_d4ter = 0;
            let computed_d5ter = 0;
            let computed_d6ter = 0;
            let computed_d7ter  = 0;
            let computed_d8ter  = 0;
            let computed_d9ter  = 0;
            let computed_d10ter = 0;
            let computed_d11ter = 0;
            let computed_d12ter = 0;
            let reussite_1ter = 0;
            let reussite_2ter = 0;
            let reussite_3ter = 0;
            let reussite_4ter = 0;
            let reussite_5ter = 0;
            let reussite_6ter = 0;
            let reussite_7ter  = 0;
            let reussite_8ter  = 0;
            let reussite_9ter  = 0;
            let reussite_10ter = 0;
            let reussite_11ter = 0;
            let reussite_12ter = 0;
            let d1quat = parseInt(results.results.d1quat.dice);
            let d2quat = parseInt(results.results.d2quat.dice);
            let d3quat = parseInt(results.results.d3quat.dice);
            let d4quat = parseInt(results.results.d4quat.dice);
            let d5quat = parseInt(results.results.d5quat.dice);
            let d6quat = parseInt(results.results.d6quat.dice);
            let d7quat  = parseInt(results.results.d7quat.dice);
            let d8quat  = parseInt(results.results.d8quat.dice);
            let d9quat  = parseInt(results.results.d9quat.dice);
            let d10quat = parseInt(results.results.d10quat.dice);
            let d11quat = parseInt(results.results.d11quat.dice);
            let d12quat = parseInt(results.results.d12quat.dice);
            let computed_d1quat = 0;
            let computed_d2quat = 0;
            let computed_d3quat = 0;
            let computed_d4quat = 0;
            let computed_d5quat = 0;
            let computed_d6quat = 0;
            let computed_d7quat  = 0;
            let computed_d8quat  = 0;
            let computed_d9quat  = 0;
            let computed_d10quat = 0;
            let computed_d11quat = 0;
            let computed_d12quat = 0;
            let reussite_1quat = 0;
            let reussite_2quat = 0;
            let reussite_3quat = 0;
            let reussite_4quat = 0;
            let reussite_5quat = 0;
            let reussite_6quat = 0;
            let reussite_7quat  = 0;
            let reussite_8quat  = 0;
            let reussite_9quat  = 0;
            let reussite_10quat = 0;
            let reussite_11quat = 0;
            let reussite_12quat = 0;
            
            let computed_relance = 0;
            let relance = 0;

                if (value == 1) nombre_de = courir;
                if (value == 2) nombre_de = encaisser;
                if (value == 3) nombre_de = escalader;
                if (value == 4) nombre_de = forcer;
                if (value == 5) nombre_de = reagir;
                if (value == 6) nombre_de = remarquer;
                if (value == 7) nombre_de = imposer;
                if (value == 8) nombre_de = sauter;
                if (value == 9) nombre_de = savoir_faire;
                if (value == 10) nombre_de = se_battre;
                if (value == 11) nombre_de = se_calmer;
                if (value == 12) nombre_de = viser;

                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
                if (d5 > 3 && nombre_de >= 5) reussite_5 = 1, computed_d5 = d5;
                if (d6 > 3 && nombre_de >= 6) reussite_6 = 1, computed_d6 = d6; 
                if (d7 >  3 && nombre_de >= 7) reussite_7  = 1, computed_d7  = d7;
                if (d8 >  3 && nombre_de >= 8) reussite_8  = 1, computed_d8  = d8;
                if (d9 >  3 && nombre_de >= 9) reussite_9  = 1, computed_d9  = d9;
                if (d10 > 3 && nombre_de >= 10) reussite_10 = 1, computed_d10 = d10;
                if (d11 > 3 && nombre_de >= 11) reussite_11 = 1, computed_d11 = d11;
                if (d12 > 3 && nombre_de >= 12) reussite_12 = 1, computed_d12 = d12;

                
                if (d1 > 5) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d4 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                if (d5 > 5 && nombre_de >= 5) computed_d5bis = d5bis, computed_relance = 1;
                if (d5 > 5 && computed_d5bis > 3 && nombre_de >= 5) reussite_5bis = 1;
                if (d6 > 5 && nombre_de >= 6) computed_d6bis = d6bis, computed_relance = 1;
                if (d6 > 5 && computed_d6bis > 3 && nombre_de >= 6) reussite_6bis = 1;
                if (d7 >  5 && nombre_de >= 7) computed_d7bis  = d7bis,  computed_relance = 1;
                if (d7 >  5 && computed_d7bis  > 3 && nombre_de >= 7) reussite_7bis  = 1;
                if (d8 >  5 && nombre_de >= 8) computed_d8bis  = d8bis,  computed_relance = 1;
                if (d8 >  5 && computed_d8bis  > 3 && nombre_de >= 8) reussite_8bis  = 1;
                if (d9 >  5 && nombre_de >= 9) computed_d9bis  = d9bis,  computed_relance = 1;
                if (d9 >  5 && computed_d9bis  > 3 && nombre_de >= 9) reussite_9bis  = 1;
                if (d10 > 5 && nombre_de >= 10) computed_d10bis = d10bis, computed_relance = 1;
                if (d10 > 5 && computed_d10bis > 3 && nombre_de >= 10) reussite_10bis = 1;
                if (d11 > 5 && nombre_de >= 11) computed_d11bis = d11bis, computed_relance = 1;
                if (d11 > 5 && computed_d11bis > 3 && nombre_de >= 11) reussite_11bis = 1;
                if (d12 > 5 && nombre_de >= 12) computed_d12bis = d12bis, computed_relance = 1;
                if (d12 > 5 && computed_d12bis > 3 && nombre_de >= 12) reussite_12bis = 1;

                if (d1ter > 5 && d1bis > 5 && d1 > 5) computed_d1ter = d1ter, computed_relance = 1;
                if (d1ter > 5 && d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1ter = 1;
                if (d2ter > 5 && d2bis > 5 && d2 > 5) computed_d2ter = d2ter, computed_relance = 1;
                if (d2ter > 5 && d2bis > 5 && d2 > 5 && computed_d2ter > 3) reussite_2ter = 1;
                if (d3ter > 5 && d3bis > 5 && d3 > 5) computed_d3ter = d3ter, computed_relance = 1;
                if (d3ter > 5 && d3bis > 5 && d3 > 5 && computed_d3ter > 3) reussite_3ter = 1;
                if (d4ter > 5 && d4bis > 5 && d4 > 5) computed_d4ter = d4ter, computed_relance = 1;
                if (d4ter > 5 && d4bis > 5 && d4 > 5 && computed_d4ter > 3) reussite_4ter = 1;
                if (d5ter > 5 && d5bis > 5 && d5 > 5) computed_d5ter = d5ter, computed_relance = 1;
                if (d5ter > 5 && d5bis > 5 && d5 > 5 && computed_d5ter > 3) reussite_5ter = 1;
                if (d6ter > 5 && d6bis > 5 && d6 > 5) computed_d6ter = d6ter, computed_relance = 1;
                if (d6ter > 5 && d6bis > 5 && d6 > 5 && computed_d6ter > 3) reussite_6ter = 1;
                if (d7ter  > 5 && d7bis  > 5 && d7  > 5) computed_d7ter  = d7ter,  computed_relance = 1;
                if (d7ter  > 5 && d7bis  > 5 && d7  > 5 && computed_d7ter  > 3) reussite_7ter  = 1;
                if (d8ter  > 5 && d8bis  > 5 && d8  > 5) computed_d8ter  = d8ter,  computed_relance = 1;
                if (d8ter  > 5 && d8bis  > 5 && d8  > 5 && computed_d8ter  > 3) reussite_8ter  = 1;
                if (d9ter  > 5 && d9bis  > 5 && d9  > 5) computed_d9ter  = d9ter,  computed_relance = 1;
                if (d9ter  > 5 && d9bis  > 5 && d9  > 5 && computed_d9ter  > 3) reussite_9ter  = 1;
                if (d10ter > 5 && d10bis > 5 && d10 > 5) computed_d10ter = d10ter, computed_relance = 1;
                if (d10ter > 5 && d10bis > 5 && d10 > 5 && computed_d10ter > 3) reussite_10ter = 1;
                if (d11ter > 5 && d11bis > 5 && d11 > 5) computed_d11ter = d11ter, computed_relance = 1;
                if (d11ter > 5 && d11bis > 5 && d11 > 5 && computed_d11ter > 3) reussite_11ter = 1;
                if (d12ter > 5 && d12bis > 5 && d12 > 5) computed_d12ter = d12ter, computed_relance = 1;
                if (d12ter > 5 && d12bis > 5 && d12 > 5 && computed_d12ter > 3) reussite_12ter = 1;

                if (d1quat > 5 && d1ter > 5 && d1bis > 5 && d1 > 5) computed_d1quat = d1quat, computed_relance = 1;
                if (d1quat > 5 && d1ter > 5 && d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1quat = 1;
                if (d2quat > 5 && d2ter > 5 && d2bis > 5 && d2 > 5) computed_d2quat = d2quat, computed_relance = 1;
                if (d2quat > 5 && d2ter > 5 && d2bis > 5 && d2 > 5 && computed_d2ter > 3) reussite_2quat = 1;
                if (d3quat > 5 && d3ter > 5 && d3bis > 5 && d3 > 5) computed_d3quat = d3quat, computed_relance = 1;
                if (d3quat > 5 && d3ter > 5 && d3bis > 5 && d3 > 5 && computed_d3ter > 3) reussite_3quat = 1;
                if (d4quat > 5 && d4ter > 5 && d4bis > 5 && d4 > 5) computed_d4quat = d4quat, computed_relance = 1;
                if (d4quat > 5 && d4ter > 5 && d4bis > 5 && d4 > 5 && computed_d4ter > 3) reussite_4quat = 1;
                if (d5quat > 5 && d5ter > 5 && d5bis > 5 && d5 > 5) computed_d5quat = d5quat, computed_relance = 1;
                if (d5quat > 5 && d5ter > 5 && d5bis > 5 && d5 > 5 && computed_d5ter > 3) reussite_5quat = 1;
                if (d6quat > 5 && d6ter > 5 && d6bis > 5 && d6 > 5) computed_d6quat = d6quat, computed_relance = 1;
                if (d6quat > 5 && d6ter > 5 && d6bis > 5 && d6 > 5 && computed_d6ter > 3) reussite_6quat = 1;
                if (d7quat  > 5 && d7ter  > 5 && d7bis  > 5 && d7  > 5) computed_d7quat  = d7quat,  computed_relance = 1;
                if (d7quat  > 5 && d7ter  > 5 && d7bis  > 5 && d7  > 5 && computed_d7quat  > 3) reussite_7quat  = 1;
                if (d8quat  > 5 && d8ter  > 5 && d8bis  > 5 && d8  > 5) computed_d8quat  = d8quat,  computed_relance = 1;
                if (d8quat  > 5 && d8ter  > 5 && d8bis  > 5 && d8  > 5 && computed_d8quat  > 3) reussite_8quat  = 1;
                if (d9quat  > 5 && d9ter  > 5 && d9bis  > 5 && d9  > 5) computed_d9quat  = d9quat,  computed_relance = 1;
                if (d9quat  > 5 && d9ter  > 5 && d9bis  > 5 && d9  > 5 && computed_d9quat  > 3) reussite_9quat  = 1;
                if (d10quat > 5 && d10ter > 5 && d10bis > 5 && d10 > 5) computed_d10quat = d10quat, computed_relance = 1;
                if (d10quat > 5 && d10ter > 5 && d10bis > 5 && d10 > 5 && computed_d10quat > 3) reussite_10quat = 1;
                if (d11quat > 5 && d11ter > 5 && d11bis > 5 && d11 > 5) computed_d11quat = d11quat, computed_relance = 1;
                if (d11quat > 5 && d11ter > 5 && d11bis > 5 && d11 > 5 && computed_d11quat > 3) reussite_11quat = 1;
                if (d12quat > 5 && d12ter > 5 && d12bis > 5 && d12 > 5) computed_d12quat = d12quat, computed_relance = 1;
                if (d12quat > 5 && d12ter > 5 && d12bis > 5 && d12 > 5 && computed_d12quat > 3) reussite_12quat = 1;

            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_5 + reussite_6 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_5bis + reussite_6bis + reussite_1ter + reussite_2ter + reussite_3ter + reussite_4ter + reussite_5ter + reussite_6ter + reussite_1quat + reussite_2quat + reussite_3quat + reussite_4quat + reussite_5quat + reussite_6quat + reussite_7  + reussite_8  + reussite_9  + reussite_10 + reussite_11 + reussite_12 + reussite_7bis  + reussite_8bis  + reussite_9bis  + reussite_10bis + reussite_11bis + reussite_12bis + reussite_7ter  + reussite_8ter  + reussite_9ter  + reussite_10ter + reussite_11ter + reussite_12ter + reussite_7quat  + reussite_8quat  + reussite_9quat  + reussite_10quat + reussite_11quat + reussite_12quat;

            difficulte_reel = parseInt(results.results.difficulte_reel.result);
            let marge_reussite = reussite_totale - difficulte_reel;

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d5: computed_d5,
                        d6: computed_d6,
                        d7:  computed_d7,  
                        d8:  computed_d8,  
                        d9:  computed_d9,      
                        d10: computed_d10, 
                        d11: computed_d11, 
                        d12: computed_d12,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d5bis: computed_d5bis,
                        d6bis: computed_d6bis,
                        d7bis:  computed_d7bis,  
                        d8bis:  computed_d8bis,  
                        d9bis:  computed_d9bis,      
                        d10bis: computed_d10bis, 
                        d11bis: computed_d11bis, 
                        d12bis: computed_d12bis,
                        d1ter: computed_d1ter,
                        d2ter: computed_d2ter,
                        d3ter: computed_d3ter,
                        d4ter: computed_d4ter,
                        d5ter: computed_d5ter,
                        d6ter: computed_d6ter,
                        d7ter:  computed_d7ter,  
                        d8ter:  computed_d8ter,  
                        d9ter:  computed_d9ter,
                        d10ter: computed_d10ter, 
                        d11ter: computed_d11ter, 
                        d12ter: computed_d12ter,
                        d1quat: computed_d1quat,
                        d2quat: computed_d2quat,
                        d3quat: computed_d3quat,
                        d4quat: computed_d4quat,
                        d5quat: computed_d5quat,
                        d6quat: computed_d6quat,
                        d7quat:  computed_d7quat,  
                        d8quat:  computed_d8quat,  
                        d9quat:  computed_d9quat,
                        d10quat: computed_d10quat, 
                        d11quat: computed_d11quat, 
                        d12quat: computed_d12quat,
                        reussite: reussite_totale,
                        relance: computed_relance,
                        nombre_de: nombre_de,
                        titre: value,
                        marge: marge_reussite
                    }
             );
        });
    });
});
</script>

<!-- Script Roll se calmer suite à échec majeur -->
<script type="text/worker">
    on('clicked:echec_majeur', (info) => {
        startRoll("&{template:tombeau} {{echec=oui}} {{title=SE CALMER}}{{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d5=[[d6]]}} {{d6=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d5bis=[[d6 (Relance du D5)]]}} {{d6bis=[[d6 (Relance du D6)]]}} {{nombre_de=[[@{se_calmer}]]}} {{difficulte=[[?{Difficulté de l'action|2|1|3|4} -1]]}} {{difficulte_reel=[[?{Difficulté de l'action|2|1|3|4}]]}} {{reussite=[[0[resultat]]]}} {{relance=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let d5 = parseInt(results.results.d5.dice);
            let d6 = parseInt(results.results.d6.dice);
            let difficulte = parseInt(results.results.difficulte.result);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let reussite_5 = 0;
            let reussite_6 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let computed_d5 = 0;
            let computed_d6 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let d5bis = parseInt(results.results.d5bis.dice);
            let d6bis = parseInt(results.results.d6bis.dice);
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let computed_d5bis = 0;
            let computed_d6bis = 0;
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let reussite_5bis = 0;
            let reussite_6bis = 0;
            let computed_relance = 0;
            let relance = 0;
    
                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
                if (d5 > 3 && nombre_de >= 5) reussite_5 = 1, computed_d5 = d5;
                if (d6 > 3 && nombre_de >= 6) reussite_6 = 1, computed_d6 = d6; 

                
                if (d1 > 5) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d4 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                if (d5 > 5 && nombre_de >= 5) computed_d5bis = d5bis, computed_relance = 1;
                if (d5 > 5 && computed_d5bis > 3 && nombre_de >= 5) reussite_5bis = 1;
                if (d6 > 5 && nombre_de >= 6) computed_d6bis = d6bis, computed_relance = 1;
                if (d6 > 5 && computed_d6bis > 3 && nombre_de >= 6) reussite_6bis = 1;

            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_5 + reussite_6 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_5bis + reussite_6bis;

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d5: computed_d5,
                        d6: computed_d6,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d5bis: computed_d5bis,
                        d6bis: computed_d6bis,
                        reussite: reussite_totale,
                        relance: computed_relance
                    }
             );
        });
    });
</script>

<!-- Script Relance d'un dés -->
<script type="text/worker">
    on('clicked:relancer_de', (info) => {
        startRoll("&{template:relance} {{relancer=oui}} {{title=RELANCE}} {{d1=[[d6]]}} {{d1bis=[[d6 (Relance du dé)]]}} {{relance=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d1bis = parseInt(results.results.d1bis.dice);
            let computed_d1bis = 0;
            let computed_relance = 0;
    
                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                else reussite_1 = 0, computed_d1 = d1;
                if (d1 > 5) computed_d1bis = d1bis, computed_relance = 1;
                else computed_d1bis = d1bis, computed_relance = 0;

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d1bis: computed_d1bis,
                        relance: computed_relance

                    }
             );
        });
    });
</script>

<!-- Script Roll dégats des armes -->
<script type="text/worker">
    on('clicked:roll_armes_1', (info) => {
        startRoll("&{template:tombeau} {{armes=oui}} {{title=@{arme_1}}}{{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d1ter=[[d6 (Relance du D1bis)]]}} {{d2ter=[[d6 (Relance du D2bis)]]}} {{d3ter=[[d6 (Relance du D3bis)]]}} {{d4ter=[[d6 (Relance du D4bis)]]}} {{d1quat=[[d6 (Relance du D1ter)]]}} {{d2quat=[[d6 (Relance du D2ter)]]}} {{d3quat=[[d6 (Relance du D3ter)]]}} {{d4quat=[[d6 (Relance du D4ter)]]}} {{nombre_de=[[@{dgt_arme_1}]]}} {{nombre_relance=[[@{dgt_arme_1_relance}]]}} {{relance=[[0[resultat]]]}} {{reussite=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let d1ter = parseInt(results.results.d1ter.dice);
            let d2ter = parseInt(results.results.d2ter.dice);
            let d3ter = parseInt(results.results.d3ter.dice);
            let d4ter = parseInt(results.results.d4ter.dice);
            let reussite_1ter = 0;
            let reussite_2ter = 0;
            let reussite_3ter = 0;
            let reussite_4ter = 0;
            let computed_d1ter = 0;
            let computed_d2ter = 0;
            let computed_d3ter = 0;
            let computed_d4ter = 0;
            let d1quat = parseInt(results.results.d1quat.dice);
            let d2quat = parseInt(results.results.d2quat.dice);
            let d3quat = parseInt(results.results.d3quat.dice);
            let d4quat = parseInt(results.results.d4quat.dice);
            let reussite_1quat = 0;
            let reussite_2quat = 0;
            let reussite_3quat = 0;
            let reussite_4quat = 0;
            let computed_d1quat = 0;
            let computed_d2quat = 0;
            let computed_d3quat = 0;
            let computed_d4quat = 0;
            let computed_relance = 0;
            let relance = 0; 
                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
    
                if (d1 > 5 && nombre_de >= 1) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d3 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                
                if (d1bis > 5 && d1 > 5) computed_d1ter = d1ter, computed_relance = 1;
                if (d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1ter = 1;
                if (d2bis > 5 && d2 > 5  && nombre_de >= 2) computed_d2ter = d2ter, computed_relance = 1;
                if (d2bis > 5 && d2 > 5  && computed_d2ter > 3 && nombre_de >= 2) reussite_2ter = 1;
                if (d3bis > 5 && d3 > 5  && nombre_de >= 3) computed_d3ter = d3ter, computed_relance = 1;
                if (d3bis > 5 && d3 > 5  && computed_d3ter > 3 && nombre_de >= 3) reussite_3ter = 1;
                if (d4bis > 5 && d4 > 5  && nombre_de >= 4) computed_d4ter = d4ter, computed_relance = 1;
                if (d4bis > 5 && d4 > 5  && computed_d4ter > 3 && nombre_de >= 4) reussite_4ter = 1;
                 
                if (d1ter > 5 && d1 > 5 && d1bis > 5) computed_d1quat = d1quat, computed_relance = 1;
                if (d1ter > 5 && d1 > 5 && d1bis > 5 && computed_d1quat > 3) reussite_1quat = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && nombre_de >= 2) computed_d2quat = d2quat, computed_relance = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && computed_d2quat > 3 && nombre_de >= 2) reussite_2quat = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && nombre_de >= 3) computed_d3quat = d3quat, computed_relance = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && computed_d3quat > 3 && nombre_de >= 3) reussite_3quat = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && nombre_de >= 4) computed_d4quat = d4quat, computed_relance = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && computed_d4quat > 3 && nombre_de >= 4) reussite_4quat = 1;
                 
            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_1ter + reussite_2ter + reussite_3ter + reussite_4ter + reussite_1quat + reussite_2quat + reussite_3quat + reussite_4quat;

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d1ter: computed_d1ter,
                        d2ter: computed_d2ter,
                        d3ter: computed_d3ter,
                        d4ter: computed_d4ter,
                        d1quat: computed_d1quat,
                        d2quat: computed_d2quat,
                        d3quat: computed_d3quat,
                        d4quat: computed_d4quat,
                        reussite: reussite_totale,
                        relance: computed_relance
                    }
             );
        });
    });

    on('clicked:roll_armes_2', (info) => {
        startRoll("&{template:tombeau} {{armes=oui}} {{title=@{arme_2}}}{{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d1ter=[[d6 (Relance du D1bis)]]}} {{d2ter=[[d6 (Relance du D2bis)]]}} {{d3ter=[[d6 (Relance du D3bis)]]}} {{d4ter=[[d6 (Relance du D4bis)]]}} {{d1quat=[[d6 (Relance du D1ter)]]}} {{d2quat=[[d6 (Relance du D2ter)]]}} {{d3quat=[[d6 (Relance du D3ter)]]}} {{d4quat=[[d6 (Relance du D4ter)]]}} {{nombre_de=[[@{dgt_arme_2}]]}} {{nombre_relance=[[@{dgt_arme_2_relance}]]}} {{relance=[[0[resultat]]]}} {{reussite=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let d1ter = parseInt(results.results.d1ter.dice);
            let d2ter = parseInt(results.results.d2ter.dice);
            let d3ter = parseInt(results.results.d3ter.dice);
            let d4ter = parseInt(results.results.d4ter.dice);
            let reussite_1ter = 0;
            let reussite_2ter = 0;
            let reussite_3ter = 0;
            let reussite_4ter = 0;
            let computed_d1ter = 0;
            let computed_d2ter = 0;
            let computed_d3ter = 0;
            let computed_d4ter = 0;
            let d1quat = parseInt(results.results.d1quat.dice);
            let d2quat = parseInt(results.results.d2quat.dice);
            let d3quat = parseInt(results.results.d3quat.dice);
            let d4quat = parseInt(results.results.d4quat.dice);
            let reussite_1quat = 0;
            let reussite_2quat = 0;
            let reussite_3quat = 0;
            let reussite_4quat = 0;
            let computed_d1quat = 0;
            let computed_d2quat = 0;
            let computed_d3quat = 0;
            let computed_d4quat = 0;
            let computed_relance = 0;
            let relance = 0;
              
                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;

                    
                if (d1 > 5 && nombre_de >= 1) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d3 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                
                if (d1bis > 5 && d1 > 5) computed_d1ter = d1ter, computed_relance = 1;
                if (d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1ter = 1;
                if (d2bis > 5 && d2 > 5  && nombre_de >= 2) computed_d2ter = d2ter, computed_relance = 1;
                if (d2bis > 5 && d2 > 5  && computed_d2ter > 3 && nombre_de >= 2) reussite_2ter = 1;
                if (d3bis > 5 && d3 > 5  && nombre_de >= 3) computed_d3ter = d3ter, computed_relance = 1;
                if (d3bis > 5 && d3 > 5  && computed_d3ter > 3 && nombre_de >= 3) reussite_3ter = 1;
                if (d4bis > 5 && d4 > 5  && nombre_de >= 4) computed_d4ter = d4ter, computed_relance = 1;
                if (d4bis > 5 && d4 > 5  && computed_d4ter > 3 && nombre_de >= 4) reussite_4ter = 1;
                 
                if (d1ter > 5 && d1 > 5 && d1bis > 5) computed_d1quat = d1quat, computed_relance = 1;
                if (d1ter > 5 && d1 > 5 && d1bis > 5 && computed_d1quat > 3) reussite_1quat = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && nombre_de >= 2) computed_d2quat = d2quat, computed_relance = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && computed_d2quat > 3 && nombre_de >= 2) reussite_2quat = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && nombre_de >= 3) computed_d3quat = d3quat, computed_relance = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && computed_d3quat > 3 && nombre_de >= 3) reussite_3quat = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && nombre_de >= 4) computed_d4quat = d4quat, computed_relance = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && computed_d4quat > 3 && nombre_de >= 4) reussite_4quat = 1;
                 
            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_1ter + reussite_2ter + reussite_3ter + reussite_4ter + reussite_1quat + reussite_2quat + reussite_3quat + reussite_4quat;

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d1ter: computed_d1ter,
                        d2ter: computed_d2ter,
                        d3ter: computed_d3ter,
                        d4ter: computed_d4ter,
                        d1quat: computed_d1quat,
                        d2quat: computed_d2quat,
                        d3quat: computed_d3quat,
                        d4quat: computed_d4quat,
                        reussite: reussite_totale,
                        relance: computed_relance
                    }
             );
        });
    });

    on('clicked:roll_armes_3', (info) => {
        startRoll("&{template:tombeau} {{armes=oui}} {{title=@{arme_3}}}{{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d1ter=[[d6 (Relance du D1bis)]]}} {{d2ter=[[d6 (Relance du D2bis)]]}} {{d3ter=[[d6 (Relance du D3bis)]]}} {{d4ter=[[d6 (Relance du D4bis)]]}} {{d1quat=[[d6 (Relance du D1ter)]]}} {{d2quat=[[d6 (Relance du D2ter)]]}} {{d3quat=[[d6 (Relance du D3ter)]]}} {{d4quat=[[d6 (Relance du D4ter)]]}} {{nombre_de=[[@{dgt_arme_3}]]}} {{nombre_relance=[[@{dgt_arme_3_relance}]]}} {{relance=[[0[resultat]]]}} {{reussite=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let d1ter = parseInt(results.results.d1ter.dice);
            let d2ter = parseInt(results.results.d2ter.dice);
            let d3ter = parseInt(results.results.d3ter.dice);
            let d4ter = parseInt(results.results.d4ter.dice);
            let reussite_1ter = 0;
            let reussite_2ter = 0;
            let reussite_3ter = 0;
            let reussite_4ter = 0;
            let computed_d1ter = 0;
            let computed_d2ter = 0;
            let computed_d3ter = 0;
            let computed_d4ter = 0;
            let d1quat = parseInt(results.results.d1quat.dice);
            let d2quat = parseInt(results.results.d2quat.dice);
            let d3quat = parseInt(results.results.d3quat.dice);
            let d4quat = parseInt(results.results.d4quat.dice);
            let reussite_1quat = 0;
            let reussite_2quat = 0;
            let reussite_3quat = 0;
            let reussite_4quat = 0;
            let computed_d1quat = 0;
            let computed_d2quat = 0;
            let computed_d3quat = 0;
            let computed_d4quat = 0;
            let computed_relance = 0;
            let relance = 0;
              
                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
     
                if (d1 > 5 && nombre_de >= 1) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d3 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                 
                if (d1bis > 5 && d1 > 5) computed_d1ter = d1ter, computed_relance = 1;
                if (d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1ter = 1;
                if (d2bis > 5 && d2 > 5  && nombre_de >= 2) computed_d2ter = d2ter, computed_relance = 1;
                if (d2bis > 5 && d2 > 5  && computed_d2ter > 3 && nombre_de >= 2) reussite_2ter = 1;
                if (d3bis > 5 && d3 > 5  && nombre_de >= 3) computed_d3ter = d3ter, computed_relance = 1;
                if (d3bis > 5 && d3 > 5  && computed_d3ter > 3 && nombre_de >= 3) reussite_3ter = 1;
                if (d4bis > 5 && d4 > 5  && nombre_de >= 4) computed_d4ter = d4ter, computed_relance = 1;
                if (d4bis > 5 && d4 > 5  && computed_d4ter > 3 && nombre_de >= 4) reussite_4ter = 1;
                 
                if (d1ter > 5 && d1 > 5 && d1bis > 5) computed_d1quat = d1quat, computed_relance = 1;
                if (d1ter > 5 && d1 > 5 && d1bis > 5 && computed_d1quat > 3) reussite_1quat = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && nombre_de >= 2) computed_d2quat = d2quat, computed_relance = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && computed_d2quat > 3 && nombre_de >= 2) reussite_2quat = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && nombre_de >= 3) computed_d3quat = d3quat, computed_relance = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && computed_d3quat > 3 && nombre_de >= 3) reussite_3quat = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && nombre_de >= 4) computed_d4quat = d4quat, computed_relance = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && computed_d4quat > 3 && nombre_de >= 4) reussite_4quat = 1;
                
            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_1ter + reussite_2ter + reussite_3ter + reussite_4ter + reussite_1quat + reussite_2quat + reussite_3quat + reussite_4quat;
console.log(computed_relance);
                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d1ter: computed_d1ter,
                        d2ter: computed_d2ter,
                        d3ter: computed_d3ter,
                        d4ter: computed_d4ter,
                        d1quat: computed_d1quat,
                        d2quat: computed_d2quat,
                        d3quat: computed_d3quat,
                        d4quat: computed_d4quat,
                        reussite: reussite_totale,
                        relance: computed_relance
                    }
             );
        });
    });

    on('clicked:roll_armes_4', (info) => {
        startRoll("&{template:tombeau} {{armes=oui}} {{title=@{arme_4}}}{{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d1bis=[[d6 (Relance du D1)]]}} {{d2bis=[[d6 (Relance du D2)]]}} {{d3bis=[[d6 (Relance du D3)]]}} {{d4bis=[[d6 (Relance du D4)]]}} {{d1ter=[[d6 (Relance du D1bis)]]}} {{d2ter=[[d6 (Relance du D2bis)]]}} {{d3ter=[[d6 (Relance du D3bis)]]}} {{d4ter=[[d6 (Relance du D4bis)]]}} {{d1quat=[[d6 (Relance du D1ter)]]}} {{d2quat=[[d6 (Relance du D2ter)]]}} {{d3quat=[[d6 (Relance du D3ter)]]}} {{d4quat=[[d6 (Relance du D4ter)]]}} {{nombre_de=[[@{dgt_arme_4}]]}} {{nombre_relance=[[@{dgt_arme_4_relance}]]}} {{relance=[[0[resultat]]]}} {{reussite=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let d1bis = parseInt(results.results.d1bis.dice);
            let d2bis = parseInt(results.results.d2bis.dice);
            let d3bis = parseInt(results.results.d3bis.dice);
            let d4bis = parseInt(results.results.d4bis.dice);
            let reussite_1bis = 0;
            let reussite_2bis = 0;
            let reussite_3bis = 0;
            let reussite_4bis = 0;
            let computed_d1bis = 0;
            let computed_d2bis = 0;
            let computed_d3bis = 0;
            let computed_d4bis = 0;
            let d1ter = parseInt(results.results.d1ter.dice);
            let d2ter = parseInt(results.results.d2ter.dice);
            let d3ter = parseInt(results.results.d3ter.dice);
            let d4ter = parseInt(results.results.d4ter.dice);
            let reussite_1ter = 0;
            let reussite_2ter = 0;
            let reussite_3ter = 0;
            let reussite_4ter = 0;
            let computed_d1ter = 0;
            let computed_d2ter = 0;
            let computed_d3ter = 0;
            let computed_d4ter = 0;
            let d1quat = parseInt(results.results.d1quat.dice);
            let d2quat = parseInt(results.results.d2quat.dice);
            let d3quat = parseInt(results.results.d3quat.dice);
            let d4quat = parseInt(results.results.d4quat.dice);
            let reussite_1quat = 0;
            let reussite_2quat = 0;
            let reussite_3quat = 0;
            let reussite_4quat = 0;
            let computed_d1quat = 0;
            let computed_d2quat = 0;
            let computed_d3quat = 0;
            let computed_d4quat = 0;
            let computed_relance = 0;
            let relance = 0;

                if (d1 > 3 && nombre_de >= 1) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
    
                if (d1 > 5) computed_d1bis = d1bis, computed_relance = 1;
                if (d1 > 5 && computed_d1bis > 3) reussite_1bis = 1;
                if (d2 > 5 && nombre_de >= 2) computed_d2bis = d2bis, computed_relance = 1;
                if (d2 > 5 && computed_d2bis > 3 && nombre_de >= 2) reussite_2bis = 1;
                if (d3 > 5 && nombre_de >= 3) computed_d3bis = d3bis, computed_relance = 1;
                if (d3 > 5 && computed_d3bis > 3 && nombre_de >= 3) reussite_3bis = 1;
                if (d4 > 5 && nombre_de >= 4) computed_d4bis = d4bis, computed_relance = 1;
                if (d4 > 5 && computed_d4bis > 3 && nombre_de >= 4) reussite_4bis = 1;
                 
                if (d1bis > 5 && d1 > 5) computed_d1ter = d1ter, computed_relance = 1;
                if (d1bis > 5 && d1 > 5 && computed_d1ter > 3) reussite_1ter = 1;
                if (d2bis > 5 && d2 > 5  && nombre_de >= 2) computed_d2ter = d2ter, computed_relance = 1;
                if (d2bis > 5 && d2 > 5  && computed_d2ter > 3 && nombre_de >= 2) reussite_2ter = 1;
                if (d3bis > 5 && d3 > 5  && nombre_de >= 3) computed_d3ter = d3ter, computed_relance = 1;
                if (d3bis > 5 && d3 > 5  && computed_d3ter > 3 && nombre_de >= 3) reussite_3ter = 1;
                if (d4bis > 5 && d4 > 5  && nombre_de >= 4) computed_d4ter = d4ter, computed_relance = 1;
                if (d4bis > 5 && d4 > 5  && computed_d4ter > 3 && nombre_de >= 4) reussite_4ter = 1;
                 
                if (d1ter > 5 && d1 > 5 && d1bis > 5) computed_d1quat = d1quat, computed_relance = 1;
                if (d1ter > 5 && d1 > 5 && d1bis > 5 && computed_d1quat > 3) reussite_1quat = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && nombre_de >= 2) computed_d2quat = d2quat, computed_relance = 1;
                if (d2ter > 5 && d2 > 5 && d2bis > 5 && computed_d2quat > 3 && nombre_de >= 2) reussite_2quat = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && nombre_de >= 3) computed_d3quat = d3quat, computed_relance = 1;
                if (d3ter > 5 && d3 > 5 && d3bis > 5 && computed_d3quat > 3 && nombre_de >= 3) reussite_3quat = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && nombre_de >= 4) computed_d4quat = d4quat, computed_relance = 1;
                if (d4ter > 5 && d4 > 5 && d4bis > 5 && computed_d4quat > 3 && nombre_de >= 4) reussite_4quat = 1;
                 
            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_1bis + reussite_2bis + reussite_3bis + reussite_4bis + reussite_1ter + reussite_2ter + reussite_3ter + reussite_4ter + reussite_1quat + reussite_2quat + reussite_3quat + reussite_4quat;
console.log(computed_relance);
                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d1bis: computed_d1bis,
                        d2bis: computed_d2bis,
                        d3bis: computed_d3bis,
                        d4bis: computed_d4bis,
                        d1ter: computed_d1ter,
                        d2ter: computed_d2ter,
                        d3ter: computed_d3ter,
                        d4ter: computed_d4ter,
                        d1quat: computed_d1quat,
                        d2quat: computed_d2quat,
                        d3quat: computed_d3quat,
                        d4quat: computed_d4quat,
                        reussite: reussite_totale,
                        relance: computed_relance
                    }
             );
        });
    });
</script>

<!-- Affichage dés des armes -->
<script type="text/worker">
    on("change:dgt_arme_1 change:dgt_arme_2 change:dgt_arme_3 change:dgt_arme_4", function() {
    
        getAttrs(["dgt_arme_1", "dgt_arme_2", "dgt_arme_3", "dgt_arme_4"], function(values) {
             let dgt_arme_1 = parseInt(values["dgt_arme_1"]) || 0;
             let dgt_arme_2 = parseInt(values["dgt_arme_2"]) || 0;
             let dgt_arme_3 = parseInt(values["dgt_arme_3"]) || 0;
             let dgt_arme_4 = parseInt(values["dgt_arme_4"]) || 0;
             let affichage_d1 = 0;
             let affichage_d2 = 0;
             let affichage_d3 = 0;
             let affichage_d4 = 0;
             
                if (dgt_arme_1 > 0) affichage_d1 = 1;
                if (dgt_arme_2 > 0) affichage_d2 = 1;
                if (dgt_arme_3 > 0) affichage_d3 = 1;
                if (dgt_arme_4 > 0) affichage_d4 = 1;
                
                setAttrs({
                "affichage_d1" : affichage_d1,
                "affichage_d2" : affichage_d2,
                "affichage_d3" : affichage_d3,
                "affichage_d4" : affichage_d4
            });
        });
    });
</script>

<!-- Calcul nombre de point aptitudes -->
<script type="text/worker">
    on("change:courir change:encaisser change:escalader change:forcer change:reagir change:remarquer change:imposer change:sauter change:savoir_faire change:se_battre change:se_calmer change:viser", function() {
    
        getAttrs(["courir", "encaisser", "escalader", "forcer", "reagir", "remarquer", "imposer", "sauter", "savoir_faire", "se_battre", "se_calmer", "viser"], function(values) {
             let courir = parseInt(values.courir) || 0;
             let encaisser = parseInt(values.encaisser) || 0;
             let escalader = parseInt(values.escalader) || 0;
             let forcer = parseInt(values.forcer) || 0;
             let reagir = parseInt(values.reagir) || 0;
             let remarquer = parseInt(values.remarquer) || 0;
             let imposer = parseInt(values.imposer) || 0;
             let sauter = parseInt(values.sauter) || 0;
             let savoir_faire = parseInt(values.savoir_faire) || 0;
             let se_battre = parseInt(values.se_battre) || 0;
             let se_calmer = parseInt(values.se_calmer) || 0;
             let viser = parseInt(values.viser) || 0;
             console.log(courir);
             let total_aptitudes = courir + encaisser + escalader + forcer + reagir + remarquer + imposer + sauter + savoir_faire + se_battre + se_calmer + viser;
             let delta_aptitudes = 42 - total_aptitudes;
            console.log(total_aptitudes);
            console.log(delta_aptitudes);
                setAttrs({
                "total_aptitudes" : total_aptitudes,
                "delta_aptitudes" : delta_aptitudes
            });
        });
    });
</script>

<!-- Affichage somme aptitudes -->
<script type="text/worker">
	on('clicked:somme_aptitudes', function() {
        getAttrs(["affichage_aptitude"], function(values) {
            let affichage_aptitude = parseInt(values["affichage_aptitude"]) || 0;
            
               if (affichage_aptitude == 0) affichage_aptitude = 1;
               else affichage_aptitude = 0;

		setAttrs({
				"affichage_aptitude" : affichage_aptitude
			});
		});
    });
</script>

<!-- --------------------------- -->
<!-- ----- ROLL TEMPLATE ------- -->
<!-- --------------------------- -->

<!-- Rolltemplate de la relance -->
<rolltemplate class="sheet-rolltemplate-relance">
    <div class="ecart"></div>
        <div class="sheet-container">
            <div class="sheet-content">
                {{#relance}}
                <div class="sheet-survivant-titre">{{title}}</div>
                <div class="sheet-resultat-des"> 
                    {{#rollGreater() computed::d1 3}}
                            <div class="sheet-value-reussite">{{computed::d1}}</div>
                    {{/rollGreater() computed::d1 3}}
                    {{#^rollGreater() computed::d1 3}}
                            <div class="sheet-value-echec">{{computed::d1}}</div>
                    {{/^rollGreater() computed::d1 3}}
                    

                    {{#rollTotal() computed::relance 1}}
                            <div class="sheet-separateur">/</div>
                        {{#rollGreater() computed::d1bis 3}}
                            <div class="sheet-value-reussite">{{d1bis}}</div>
                        {{/rollGreater() computed::d1bis 3}}
                        {{#^rollGreater() computed::d1bis 3}}
                            <div class="sheet-value-echec">{{d1bis}}</div>
                        {{/^rollGreater() computed::d1bis 3}}
                    {{/rollTotal() computed::relance 1}}
                </div>
                {{/relance}}
                {{#test}}
                    {{#rollTotal() computed::titre 1}}
                        <div class="sheet-survivant-titre">titre 1</div>
                    {{/rollTotal() computed::titre 1}}
                    {{#rollTotal() computed::titre 2}}
                        <div class="sheet-survivant-titre">titre 2</div>
                    {{/rollTotal() computed::titre 2}}
                    {{#rollTotal() computed::titre 3}}
                        <div class="sheet-survivant-titre">titre 2</div>
                    {{/rollTotal() computed::titre 3}}
                {{/test}}
            </div>
        </div>
</rolltemplate>

<!-- Rolltemplate des aptitudes -->
<rolltemplate class="sheet-rolltemplate-aptitude">
    <div class="ecart"></div>
        <!-- On va verifier le nombre de dés et les relance -->
        {{#rollGreater() computed::nombre_de 6}}
        {{#rollTotal() computed::relance 0}}
        <!-- Si comp sup 6 et pas relance = 1 -->
         <div class="sheet-container-2">
            <div class="sheet-content-2">
        {{/rollTotal() computed::relance 0}}
        {{#rollTotal() computed::relance 1}}
        <!-- Si comp sup 6 et relance = 2 -->
         <div class="sheet-container-3">
            <div class="sheet-content-3">
        {{/rollTotal() computed::relance 1}}
        {{/rollGreater() computed::nombre_de 6}}
        {{#^rollGreater() computed::nombre_de 6}}
        {{#rollTotal() computed::relance 0}}
        <!-- Si comp infi 7 et pas relance = 3 -->
         <div class="sheet-container-1">
            <div class="sheet-content-1">
        {{/rollTotal() computed::relance 0}}
        {{#rollTotal() computed::relance 1}}
        <!-- Si comp inf 7 et relance = 4 -->
         <div class="sheet-container-2">
            <div class="sheet-content-2">
        {{/rollTotal() computed::relance 1}}
        {{/^rollGreater() computed::nombre_de 6}}
        
            
                <!-- Titre -->
                {{#rollTotal() computed::titre 1}}   
                <div class="sheet-survivant-titre">COURIR</div>
                {{/rollTotal() computed::titre 1}}
                {{#rollTotal() computed::titre 2}}   
                <div class="sheet-survivant-titre">ENCAISSER</div>
                {{/rollTotal() computed::titre 2}}
                {{#rollTotal() computed::titre 3}}   
                <div class="sheet-survivant-titre">ESCALADER</div>
                {{/rollTotal() computed::titre 3}}
                {{#rollTotal() computed::titre 4}}   
                <div class="sheet-survivant-titre">FORCER</div>
                {{/rollTotal() computed::titre 4}}
                {{#rollTotal() computed::titre 5}}   
                <div class="sheet-survivant-titre">RÉAGIR</div>
                {{/rollTotal() computed::titre 5}}
                {{#rollTotal() computed::titre 6}}   
                <div class="sheet-survivant-titre">REMARQUER</div>
                {{/rollTotal() computed::titre 6}}
                {{#rollTotal() computed::titre 7}}   
                <div class="sheet-survivant-titre">S'IMPOSER</div>
                {{/rollTotal() computed::titre 7}}
                {{#rollTotal() computed::titre 8}}   
                <div class="sheet-survivant-titre">SAUTER</div>
                {{/rollTotal() computed::titre 8}}
                {{#rollTotal() computed::titre 9}}   
                <div class="sheet-survivant-titre">SAVOIR-FAIRE</div>
                {{/rollTotal() computed::titre 9}}
                {{#rollTotal() computed::titre 10}}   
                <div class="sheet-survivant-titre">SE BATTRE</div>
                {{/rollTotal() computed::titre 10}}
                {{#rollTotal() computed::titre 11}}   
                <div class="sheet-survivant-titre">SE CALMER</div>
                {{/rollTotal() computed::titre 11}}
                {{#rollTotal() computed::titre 12}}   
                <div class="sheet-survivant-titre">VISER</div>
                {{/rollTotal() computed::titre 12}}

                {{#rollTotal() difficulte_reel 1}}
                <div class="sheet-survivant-dif-titre">Relativement facile (1+)</div>
                {{/rollTotal() difficulte_reel 1}}
                {{#rollTotal() difficulte_reel 2}}
                <div class="sheet-survivant-dif-titre">Moyenne (2+)</div>
                {{/rollTotal() difficulte_reel 2}}
                {{#rollTotal() difficulte_reel 3}}
                <div class="sheet-survivant-dif-titre">Difficile (3+)</div>
                {{/rollTotal() difficulte_reel 3}}
                {{#rollTotal() difficulte_reel 4}}
                <div class="sheet-survivant-dif-titre">Trés difficile (4+)</div>
                {{/rollTotal() difficulte_reel 4}}
                
                
                <div class="sheet-resultat-des6">
                    {{#rollGreater() computed::nombre_de 0}}
                        {{#rollGreater() computed::d1 3}}
                        <div class="sheet-value-reussite">{{d1}}</div>
                        {{/rollGreater() computed::d1 3}}
                        {{#^rollGreater() computed::d1 3}}
                        <div class="sheet-value-echec">{{d1}}</div>
                        {{/^rollGreater() computed::d1 3}}
                    {{/rollGreater() computed::nombre_de 0}}
                    {{#rollGreater() computed::nombre_de 1}}
                        {{#rollGreater() computed::d2 3}}
                        <div class="sheet-value-reussite">{{d2}}</div>
                        {{/rollGreater() computed::d2 3}}
                        {{#^rollGreater() computed::d2 3}}
                        <div class="sheet-value-echec">{{d2}}</div>
                        {{/^rollGreater() computed::d2 3}}
                    {{/rollGreater() computed::nombre_de 1}}
                    {{#rollGreater() computed::nombre_de 2}}
                        {{#rollGreater() computed::d3 3}}
                        <div class="sheet-value-reussite">{{d3}}</div>
                        {{/rollGreater() computed::d3 3}}
                        {{#^rollGreater() computed::d3 3}}
                        <div class="sheet-value-echec">{{d3}}</div>
                        {{/^rollGreater() computed::d3 3}}
                    {{/rollGreater() computed::nombre_de 2}}
                    {{#rollGreater() computed::nombre_de 3}}
                        {{#rollGreater() computed::d4 3}}
                        <div class="sheet-value-reussite">{{d4}}</div>
                        {{/rollGreater() computed::d4 3}}
                        {{#^rollGreater() computed::d4 3}}
                        <div class="sheet-value-echec">{{d4}}</div>
                        {{/^rollGreater() computed::d4 3}}
                    {{/rollGreater() computed::nombre_de 3}}
                    {{#rollGreater() computed::nombre_de 4}}
                        {{#rollGreater() computed::d5 3}}
                        <div class="sheet-value-reussite">{{d5}}</div>
                        {{/rollGreater() computed::d5 3}}
                        {{#^rollGreater() computed::d5 3}}
                        <div class="sheet-value-echec">{{d5}}</div>
                        {{/^rollGreater() computed::d5 3}}
                    {{/rollGreater() computed::nombre_de 4}}
                    {{#rollGreater() computed::nombre_de 5}}
                        {{#rollGreater() computed::d6 3}}
                        <div class="sheet-value-reussite">{{d6}}</div>
                        {{/rollGreater() computed::d6 3}}
                        {{#^rollGreater() computed::d6 3}}
                        <div class="sheet-value-echec">{{d6}}</div>
                        {{/^rollGreater() computed::d6 3}}
                    {{/rollGreater() computed::nombre_de 5}}
                </div>
                <!-- On va verifier le nombre de dés et les relance -->
                {{#rollGreater() computed::nombre_de 6}}
                <div class="sheet-resultat-des12">
                    {{#rollGreater() computed::nombre_de 6}}
                        <br /><br />{{#rollGreater() computed::d7 3}}
                        <div class="sheet-value-reussite">{{d7}}</div>
                        {{/rollGreater() computed::d7 3}}
                        {{#^rollGreater() computed::d7 3}}
                        <div class="sheet-value-echec">{{d7}}</div>
                        {{/^rollGreater() computed::d7 3}}
                    {{/rollGreater() computed::nombre_de 6}}
                    {{#rollGreater() computed::nombre_de 7}}
                        {{#rollGreater() computed::d8 3}}
                        <div class="sheet-value-reussite">{{d8}}</div>
                        {{/rollGreater() computed::d8 3}}
                        {{#^rollGreater() computed::d8 3}}
                        <div class="sheet-value-echec">{{d8}}</div>
                        {{/^rollGreater() computed::d8 3}}
                    {{/rollGreater() computed::nombre_de 7}}
                    {{#rollGreater() computed::nombre_de 8}}
                        {{#rollGreater() computed::d9 3}}
                        <div class="sheet-value-reussite">{{d9}}</div>
                        {{/rollGreater() computed::d9 3}}
                        {{#^rollGreater() computed::d9 3}}
                        <div class="sheet-value-echec">{{d9}}</div>
                        {{/^rollGreater() computed::d9 3}}
                    {{/rollGreater() computed::nombre_de 8}}
                    {{#rollGreater() computed::nombre_de 9}}
                        {{#rollGreater() computed::d10 3}}
                        <div class="sheet-value-reussite">{{d10}}</div>
                        {{/rollGreater() computed::d10 3}}
                        {{#^rollGreater() computed::d10 3}}
                        <div class="sheet-value-echec">{{d10}}</div>
                        {{/^rollGreater() computed::d10 3}}
                    {{/rollGreater() computed::nombre_de 9}}
                    {{#rollGreater() computed::nombre_de 10}}
                        {{#rollGreater() computed::d11 3}}
                        <div class="sheet-value-reussite">{{d11}}</div>
                        {{/rollGreater() computed::d11 3}}
                        {{#^rollGreater() computed::d11 3}}
                        <div class="sheet-value-echec">{{d11}}</div>
                        {{/^rollGreater() computed::d11 3}}
                    {{/rollGreater() computed::nombre_de 10}}
                    {{#rollGreater() computed::nombre_de 11}}
                        {{#rollGreater() computed::d12 3}}
                        <div class="sheet-value-reussite">{{d12}}</div>
                        {{/rollGreater() computed::d12 3}}
                        {{#^rollGreater() computed::d12 3}}
                        <div class="sheet-value-echec">{{d12}}</div>
                        {{/^rollGreater() computed::d12 3}}
                    {{/rollGreater() computed::nombre_de 11}}
                </div>
                {{/rollGreater() computed::nombre_de 6}}
                 <!-- On va verifier le nombre de dés et les relance -->
                {{#rollTotal() computed::relance 1}}  
                {{#rollGreater() computed::nombre_de 6}}
                <!-- Si comp sup 6 -->
                <div class="sheet-resultat-des-relance-2">
                {{/rollGreater() computed::nombre_de 6}}
                <!-- Si comp inf 7 -->
                {{#^rollGreater() computed::nombre_de 6}}
                <div class="sheet-resultat-des-relance-1">
                    {{/^rollGreater() computed::nombre_de 6}}
                    {{#rollTotal() computed::relance 1}}Relances : {{/rollTotal() computed::relance 1}}
                    <!-- Dés bonus bis -->
                    {{#rollGreater() computed::d1 5}}
                        {{#rollGreater() computed::d1bis 3}}
                        <div class="sheet-value-reussite">{{d1bis}}</div>
                        {{/rollGreater() computed::d1bis 3}}
                        {{#^rollGreater() computed::d1bis 3}}
                        <div class="sheet-value-echec">{{d1bis}}</div>
                        {{/^rollGreater() computed::d1bis 3}}
                    {{/rollGreater() computed::d1 5}}
                    {{#rollGreater() computed::d2 5}}
                        {{#rollGreater() computed::d2bis 3}}
                        <div class="sheet-value-reussite">{{d2bis}}</div>
                        {{/rollGreater() computed::d2bis 3}}
                        {{#^rollGreater() computed::d2bis 3}}
                        <div class="sheet-value-echec">{{d2bis}}</div>
                        {{/^rollGreater() computed::d2bis 3}}
                    {{/rollGreater() computed::d2 5}}
                    {{#rollGreater() computed::d3 5}}
                        {{#rollGreater() computed::d3bis 3}}
                        <div class="sheet-value-reussite">{{d3bis}}</div>
                        {{/rollGreater() computed::d3bis 3}}
                        {{#^rollGreater() computed::d3bis 3}}
                        <div class="sheet-value-echec">{{d3bis}}</div>
                        {{/^rollGreater() computed::d3bis 3}}
                    {{/rollGreater() computed::d3 5}}
                    {{#rollGreater() computed::d4 5}}
                        {{#rollGreater() computed::d4bis 3}}
                        <div class="sheet-value-reussite">{{d4bis}}</div>
                        {{/rollGreater() computed::d4bis 3}}
                        {{#^rollGreater() computed::d4bis 3}}
                        <div class="sheet-value-echec">{{d4bis}}</div>
                        {{/^rollGreater() computed::d4bis 3}}
                    {{/rollGreater() computed::d4 5}}
                    {{#rollGreater() computed::d5 5}}
                        {{#rollGreater() computed::d5bis 3}}
                        <div class="sheet-value-reussite">{{d5bis}}</div>
                        {{/rollGreater() computed::d5bis 3}}
                        {{#^rollGreater() computed::d5bis 3}}
                        <div class="sheet-value-echec">{{d5bis}}</div>
                        {{/^rollGreater() computed::d5bis 3}}
                    {{/rollGreater() computed::d5 5}}
                    {{#rollGreater() computed::d6 5}}
                        {{#rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-reussite">{{d6bis}}</div>
                        {{/rollGreater() computed::d6bis 3}}
                        {{#^rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-echec">{{d6bis}}</div>
                        {{/^rollGreater() computed::d6bis 3}}
                    {{/rollGreater() computed::d6 5}}
                    {{#rollGreater() computed::d7 5}}
                        {{#rollGreater() computed::d7bis 3}}
                        <div class="sheet-value-reussite">{{d7bis}}</div>
                        {{/rollGreater() computed::d7bis 3}}
                        {{#^rollGreater() computed::d7bis 3}}
                        <div class="sheet-value-echec">{{d7bis}}</div>
                        {{/^rollGreater() computed::d7bis 3}}
                    {{/rollGreater() computed::d7 5}}
                    {{#rollGreater() computed::d8 5}}
                        {{#rollGreater() computed::d8bis 3}}
                        <div class="sheet-value-reussite">{{d8bis}}</div>
                        {{/rollGreater() computed::d8bis 3}}
                        {{#^rollGreater() computed::d8bis 3}}
                        <div class="sheet-value-echec">{{d8bis}}</div>
                        {{/^rollGreater() computed::d8bis 3}}
                    {{/rollGreater() computed::d8 5}}
                    {{#rollGreater() computed::d9 5}}
                        {{#rollGreater() computed::d9bis 3}}
                        <div class="sheet-value-reussite">{{d9bis}}</div>
                        {{/rollGreater() computed::d9bis 3}}
                        {{#^rollGreater() computed::d9bis 3}}
                        <div class="sheet-value-echec">{{d9bis}}</div>
                        {{/^rollGreater() computed::d9bis 3}}
                    {{/rollGreater() computed::d9 5}}
                    {{#rollGreater() computed::d10 5}}
                        {{#rollGreater() computed::d10bis 3}}
                        <div class="sheet-value-reussite">{{d10bis}}</div>
                        {{/rollGreater() computed::d10bis 3}}
                        {{#^rollGreater() computed::d10bis 3}}
                        <div class="sheet-value-echec">{{d10bis}}</div>
                        {{/^rollGreater() computed::d10bis 3}}
                    {{/rollGreater() computed::d10 5}}
                    {{#rollGreater() computed::d11 5}}
                        {{#rollGreater() computed::d11bis 3}}
                        <div class="sheet-value-reussite">{{d11bis}}</div>
                        {{/rollGreater() computed::d11bis 3}}
                        {{#^rollGreater() computed::d11bis 3}}
                        <div class="sheet-value-echec">{{d11bis}}</div>
                        {{/^rollGreater() computed::d11bis 3}}
                    {{/rollGreater() computed::d11 5}}
                    {{#rollGreater() computed::d12 5}}
                        {{#rollGreater() computed::d12bis 3}}
                        <div class="sheet-value-reussite">{{d12bis}}</div>
                        {{/rollGreater() computed::d12bis 3}}
                        {{#^rollGreater() computed::d12bis 3}}
                        <div class="sheet-value-echec">{{d12bis}}</div>
                        {{/^rollGreater() computed::d12bis 3}}
                    {{/rollGreater() computed::d12 5}}
                    <!-- Dé TER -->
                    {{#rollGreater() computed::d1bis 5}}
                        {{#rollGreater() computed::d1ter 3}}
                        <div class="sheet-value-reussite">{{d1ter}}</div>
                        {{/rollGreater() computed::d1ter 3}}
                        {{#^rollGreater() computed::d1ter 3}}
                        <div class="sheet-value-echec">{{d1ter}}</div>
                        {{/^rollGreater() computed::d1ter 3}}
                    {{/rollGreater() computed::d1bis 5}}
                    {{#rollGreater() computed::d2bis 5}}
                        {{#rollGreater() computed::d2ter 3}}
                        <div class="sheet-value-reussite">{{d2ter}}</div>
                        {{/rollGreater() computed::d2ter 3}}
                        {{#^rollGreater() computed::d2ter 3}}
                        <div class="sheet-value-echec">{{d2ter}}</div>
                        {{/^rollGreater() computed::d2ter 3}}
                    {{/rollGreater() computed::d2bis 5}}
                    {{#rollGreater() computed::d3bis 5}}
                        {{#rollGreater() computed::d3ter 3}}
                        <div class="sheet-value-reussite">{{d3ter}}</div>
                        {{/rollGreater() computed::d3ter 3}}
                        {{#^rollGreater() computed::d3ter 3}}
                        <div class="sheet-value-echec">{{d3ter}}</div>
                        {{/^rollGreater() computed::d3ter 3}}
                    {{/rollGreater() computed::d3bis 5}}
                    {{#rollGreater() computed::d4bis 5}}
                        {{#rollGreater() computed::d4ter 3}}
                        <div class="sheet-value-reussite">{{d4ter}}</div>
                        {{/rollGreater() computed::d4ter 3}}
                        {{#^rollGreater() computed::d4ter 3}}
                        <div class="sheet-value-echec">{{d4ter}}</div>
                        {{/^rollGreater() computed::d4ter 3}}
                    {{/rollGreater() computed::d4bis 5}}
                    {{#rollGreater() computed::d5bis 5}}
                        {{#rollGreater() computed::d5ter 3}}
                        <div class="sheet-value-reussite">{{d5ter}}</div>
                        {{/rollGreater() computed::d5ter 3}}
                        {{#^rollGreater() computed::d5ter 3}}
                        <div class="sheet-value-echec">{{d5ter}}</div>
                        {{/^rollGreater() computed::d5ter 3}}
                    {{/rollGreater() computed::d5bis 5}}
                    {{#rollGreater() computed::d6bis 5}}
                        {{#rollGreater() computed::d6ter 3}}
                        <div class="sheet-value-reussite">{{d6ter}}</div>
                        {{/rollGreater() computed::d6ter 3}}
                        {{#^rollGreater() computed::d6ter 3}}
                        <div class="sheet-value-echec">{{d6ter}}</div>
                        {{/^rollGreater() computed::d6ter 3}}
                    {{/rollGreater() computed::d6bis 5}}
                    {{#rollGreater() computed::d7bis 5}}
                        {{#rollGreater() computed::d7ter 3}}
                        <div class="sheet-value-reussite">{{d7ter}}</div>
                        {{/rollGreater() computed::d7ter 3}}
                        {{#^rollGreater() computed::d7ter 3}}
                        <div class="sheet-value-echec">{{d7ter}}</div>
                        {{/^rollGreater() computed::d7ter 3}}
                    {{/rollGreater() computed::d7bis 5}}
                    {{#rollGreater() computed::d8bis 5}}
                        {{#rollGreater() computed::d8ter 3}}
                        <div class="sheet-value-reussite">{{d8ter}}</div>
                        {{/rollGreater() computed::d8ter 3}}
                        {{#^rollGreater() computed::d8ter 3}}
                        <div class="sheet-value-echec">{{d8ter}}</div>
                        {{/^rollGreater() computed::d8ter 3}}
                    {{/rollGreater() computed::d8bis 5}}
                    {{#rollGreater() computed::d9bis 5}}
                        {{#rollGreater() computed::d9ter 3}}
                        <div class="sheet-value-reussite">{{d9ter}}</div>
                        {{/rollGreater() computed::d9ter 3}}
                        {{#^rollGreater() computed::d9ter 3}}
                        <div class="sheet-value-echec">{{d9ter}}</div>
                        {{/^rollGreater() computed::d9ter 3}}
                    {{/rollGreater() computed::d9bis 5}}
                    {{#rollGreater() computed::d10bis 5}}
                        {{#rollGreater() computed::d10ter 3}}
                        <div class="sheet-value-reussite">{{d10ter}}</div>
                        {{/rollGreater() computed::d10ter 3}}
                        {{#^rollGreater() computed::d10ter 3}}
                        <div class="sheet-value-echec">{{d10ter}}</div>
                        {{/^rollGreater() computed::d10ter 3}}
                    {{/rollGreater() computed::d10bis 5}}
                    {{#rollGreater() computed::d11bis 5}}
                        {{#rollGreater() computed::d11ter 3}}
                        <div class="sheet-value-reussite">{{d11ter}}</div>
                        {{/rollGreater() computed::d11ter 3}}
                        {{#^rollGreater() computed::d11ter 3}}
                        <div class="sheet-value-echec">{{d11ter}}</div>
                        {{/^rollGreater() computed::d11ter 3}}
                    {{/rollGreater() computed::d11bis 5}}
                    {{#rollGreater() computed::d12bis 5}}
                        {{#rollGreater() computed::d12ter 3}}
                        <div class="sheet-value-reussite">{{d12ter}}</div>
                        {{/rollGreater() computed::d12ter 3}}
                        {{#^rollGreater() computed::d12ter 3}}
                        <div class="sheet-value-echec">{{d12ter}}</div>
                        {{/^rollGreater() computed::d12ter 3}}
                    {{/rollGreater() computed::d12bis 5}}
                    <!-- Dé QUATTRO -->
                    {{#rollGreater() computed::d1ter 5}}
                        {{#rollGreater() computed::d1quat 3}}
                        <div class="sheet-value-reussite">{{d1quat}}</div>
                        {{/rollGreater() computed::d1quat 3}}
                        {{#^rollGreater() computed::d1quat 3}}
                        <div class="sheet-value-echec">{{d1quat}}</div>
                        {{/^rollGreater() computed::d1quat 3}}
                    {{/rollGreater() computed::d1ter 5}}
                    {{#rollGreater() computed::d2ter 5}}
                        {{#rollGreater() computed::d2quat 3}}
                        <div class="sheet-value-reussite">{{d2quat}}</div>
                        {{/rollGreater() computed::d2quat 3}}
                        {{#^rollGreater() computed::d2quat 3}}
                        <div class="sheet-value-echec">{{d2quat}}</div>
                        {{/^rollGreater() computed::d2quat 3}}
                    {{/rollGreater() computed::d2ter 5}}
                    {{#rollGreater() computed::d3ter 5}}
                        {{#rollGreater() computed::d3quat 3}}
                        <div class="sheet-value-reussite">{{d3quat}}</div>
                        {{/rollGreater() computed::d3quat 3}}
                        {{#^rollGreater() computed::d3quat 3}}
                        <div class="sheet-value-echec">{{d3quat}}</div>
                        {{/^rollGreater() computed::d3quat 3}}
                    {{/rollGreater() computed::d3ter 5}}
                    {{#rollGreater() computed::d4ter 5}}
                        {{#rollGreater() computed::d4quat 3}}
                        <div class="sheet-value-reussite">{{d4quat}}</div>
                        {{/rollGreater() computed::d4quat 3}}
                        {{#^rollGreater() computed::d4quat 3}}
                        <div class="sheet-value-echec">{{d4quat}}</div>
                        {{/^rollGreater() computed::d4quat 3}}
                    {{/rollGreater() computed::d4ter 5}}
                    {{#rollGreater() computed::d5ter 5}}
                        {{#rollGreater() computed::d5quat 3}}
                        <div class="sheet-value-reussite">{{d5quat}}</div>
                        {{/rollGreater() computed::d5quat 3}}
                        {{#^rollGreater() computed::d5quat 3}}
                        <div class="sheet-value-echec">{{d5quat}}</div>
                        {{/^rollGreater() computed::d5quat 3}}
                    {{/rollGreater() computed::d5ter 5}}
                    {{#rollGreater() computed::d6ter 5}}
                        {{#rollGreater() computed::d6quat 3}}
                        <div class="sheet-value-reussite">{{d6quat}}</div>
                        {{/rollGreater() computed::d6quat 3}}
                        {{#^rollGreater() computed::d6quat 3}}
                        <div class="sheet-value-echec">{{d6quat}}</div>
                        {{/^rollGreater() computed::d6quat 3}}
                    {{/rollGreater() computed::d6ter 5}}
                    {{#rollGreater() computed::d7ter 5}}
                        {{#rollGreater() computed::d7quat 3}}
                        <div class="sheet-value-reussite">{{d7quat}}</div>
                        {{/rollGreater() computed::d7quat 3}}
                        {{#^rollGreater() computed::d7quat 3}}
                        <div class="sheet-value-echec">{{d7quat}}</div>
                        {{/^rollGreater() computed::d7quat 3}}
                    {{/rollGreater() computed::d7ter 5}}
                    {{#rollGreater() computed::d8ter 5}}
                        {{#rollGreater() computed::d8quat 3}}
                        <div class="sheet-value-reussite">{{d8quat}}</div>
                        {{/rollGreater() computed::d8quat 3}}
                        {{#^rollGreater() computed::d8quat 3}}
                        <div class="sheet-value-echec">{{d8quat}}</div>
                        {{/^rollGreater() computed::d8quat 3}}
                    {{/rollGreater() computed::d8ter 5}}
                    {{#rollGreater() computed::d9ter 5}}
                        {{#rollGreater() computed::d9quat 3}}
                        <div class="sheet-value-reussite">{{d9quat}}</div>
                        {{/rollGreater() computed::d9quat 3}}
                        {{#^rollGreater() computed::d9quat 3}}
                        <div class="sheet-value-echec">{{d9quat}}</div>
                        {{/^rollGreater() computed::d9quat 3}}
                    {{/rollGreater() computed::d9ter 5}}
                    {{#rollGreater() computed::d10ter 5}}
                        {{#rollGreater() computed::d10quat 3}}
                        <div class="sheet-value-reussite">{{d10quat}}</div>
                        {{/rollGreater() computed::d10quat 3}}
                        {{#^rollGreater() computed::d10quat 3}}
                        <div class="sheet-value-echec">{{d10quat}}</div>
                        {{/^rollGreater() computed::d10quat 3}}
                    {{/rollGreater() computed::d10ter 5}}
                    {{#rollGreater() computed::d11ter 5}}
                        {{#rollGreater() computed::d11quat 3}}
                        <div class="sheet-value-reussite">{{d11quat}}</div>
                        {{/rollGreater() computed::d11quat 3}}
                        {{#^rollGreater() computed::d11quat 3}}
                        <div class="sheet-value-echec">{{d11quat}}</div>
                        {{/^rollGreater() computed::d11quat 3}}
                    {{/rollGreater() computed::d11ter 5}}
                    {{#rollGreater() computed::d12ter 5}}
                        {{#rollGreater() computed::d12quat 3}}
                        <div class="sheet-value-reussite">{{d12quat}}</div>
                        {{/rollGreater() computed::d12quat 3}}
                        {{#^rollGreater() computed::d12quat 3}}
                        <div class="sheet-value-echec">{{d12quat}}</div>
                        {{/^rollGreater() computed::d12quat 3}}
                    {{/rollGreater() computed::d12ter 5}}

                </div>
                {{/rollTotal() computed::relance 1}}  
                <!-- On va verifier le nombre de dés et les relance -->
                {{#rollGreater() computed::nombre_de 6}}
                {{#rollTotal() computed::relance 0}}
                <!-- Si comp inferieur 7 et pas relance = 1 -->


                    {{#rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-reussite1-1">RÉUSSITE
                                {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-echec1">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/rollTotal() difficulte 0}}
                    {{#^rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite1-1">RÉUSSITE MAJEURE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                                <div class="sheet-desc-adrenaline_gain-1">Vous gagnez 1 point d'Adrénaline</div>
                            {{/rollGreater() computed::reussite difficulte_reel}}
                            {{#^rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite2-1">RÉUSSITE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/^rollGreater() computed::reussite difficulte_reel}}
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec2-1">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/rollGreater() computed::reussite 0}}
                            {{#^rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec1-1">ÉCHEC MAJEUR
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            <div class="sheet-desc-adrenaline_perte-1">[Vous perdez 1 point d'Adrénaline mais vous pouvez tentez-de vous calmer...](~selected|echec_majeur)</div>
                            {{/^rollGreater() computed::reussite 0}}    
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/^rollTotal() difficulte 0}}
                {{/rollTotal() computed::relance 0}}
                {{#rollTotal() computed::relance 1}}
                <!-- Si comp inferieur 7 et relance = 2 -->
                <!-- Si comp inferieur 7 et pas relance = 1 -->

                    {{#rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-reussite1-2">RÉUSSITE
                                {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-echec1-2">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/rollTotal() difficulte 0}}
                    {{#^rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite1-2">RÉUSSITE MAJEURE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                                <div class="sheet-desc-adrenaline_gain-2">Vous gagnez 1 point d'Adrénaline</div>
                            {{/rollGreater() computed::reussite difficulte_reel}}
                            {{#^rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite2-2">RÉUSSITE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/^rollGreater() computed::reussite difficulte_reel}}
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec2-2">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/rollGreater() computed::reussite 0}}
                            {{#^rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec1-2">ÉCHEC MAJEUR
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            <div class="sheet-desc-adrenaline_perte-2">[Vous perdez 1 point d'Adrénaline mais vous pouvez tentez-de vous calmer...](~selected|echec_majeur)</div>
                            {{/^rollGreater() computed::reussite 0}}    
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/^rollTotal() difficulte 0}}
                {{/rollTotal() computed::relance 1}}
                {{/rollGreater() computed::nombre_de 6}}
                {{#^rollGreater() computed::nombre_de 6}}
                {{#rollTotal() computed::relance 0}}
                <!-- Si comp superieur 6 et pas relance = 3 -->


                    {{#rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-reussite1-2">RÉUSSITE
                                {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-echec1-2">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/rollTotal() difficulte 0}}
                    {{#^rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite1-2">RÉUSSITE MAJEURE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                                <div class="sheet-desc-adrenaline_gain-2">Vous gagnez 1 point d'Adrénaline</div>
                            {{/rollGreater() computed::reussite difficulte_reel}}
                            {{#^rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite2-2">RÉUSSITE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/^rollGreater() computed::reussite difficulte_reel}}
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec2-2">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/rollGreater() computed::reussite 0}}
                            {{#^rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec1-2">ÉCHEC MAJEUR
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            <div class="sheet-desc-adrenaline_perte-2">[Vous perdez 1 point d'Adrénaline mais vous pouvez tentez-de vous calmer...](~selected|echec_majeur)</div>
                            {{/^rollGreater() computed::reussite 0}}    
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/^rollTotal() difficulte 0}}
                {{/rollTotal() computed::relance 0}}
                {{#rollTotal() computed::relance 1}}
                <!-- Si comp superieur 6 et relance = 4 -->


                    {{#rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-reussite1-3">RÉUSSITE
                                {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            <div class="sheet-desc-echec1-3">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/rollTotal() difficulte 0}}
                    {{#^rollTotal() difficulte 0}}
                        {{#^rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite1-3">RÉUSSITE MAJEURE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                                <div class="sheet-desc-adrenaline_gain-3">Vous gagnez 1 point d'Adrénaline</div>
                            {{/rollGreater() computed::reussite difficulte_reel}}
                            {{#^rollGreater() computed::reussite difficulte_reel}}
                                <div class="sheet-desc-reussite2-3">RÉUSSITE
                                    {{#^rollTotal() computed::marge 0}} (+{{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/^rollGreater() computed::reussite difficulte_reel}}
                        {{/^rollLess() computed::reussite difficulte_reel}}
                        {{#rollLess() computed::reussite difficulte_reel}}
                            {{#rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec2-3">ÉCHEC
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            {{/rollGreater() computed::reussite 0}}
                            {{#^rollGreater() computed::reussite 0}}  
                            <div class="sheet-desc-echec1-3">ÉCHEC MAJEUR
                                {{#^rollTotal() computed::marge 0}} ({{computed::marge}}){{/^rollTotal() computed::marge 0}}</div>
                            <div class="sheet-desc-adrenaline_perte-3">[Vous perdez 1 point d'Adrénaline mais vous pouvez tentez-de vous calmer...](~selected|echec_majeur)</div>
                            {{/^rollGreater() computed::reussite 0}}    
                        {{/rollLess() computed::reussite difficulte_reel}}
                    {{/^rollTotal() difficulte 0}}
                {{/rollTotal() computed::relance 1}}
                {{/^rollGreater() computed::nombre_de 6}}
            </div>
        </div>
</rolltemplate>

<!-- Tous les autres Rolltemplate -->
<rolltemplate class="sheet-rolltemplate-tombeau">
    <div class="ecart"></div>
        <div class="sheet-container">
            <div class="sheet-content">
                    {{#armes}}
                <div class="sheet-survivant-titre">{{title}}</div>   
                    {{/armes}}
                    {{#sauvagerie}}
                <div class="sheet-survivant-titre" style="font-size: 20px;">{{title}}</div>   
                    {{/sauvagerie}}
                    {{#rollTotal() difficulte 0}}
                <div class="sheet-survivant-titre" title="Action relativement facile (1)">{{title}}</div>
                    {{/rollTotal() difficulte 0}}
                    {{#rollTotal() difficulte 1}}
                <div class="sheet-survivant-titre" title="Action moyenne (2)">{{title}}</div>
                    {{/rollTotal() difficulte 1}}
                    {{#rollTotal() difficulte 2}}
                <div class="sheet-survivant-titre" title="Action difficile (3)">{{title}}</div>
                    {{/rollTotal() difficulte 2}}
                    {{#rollTotal() difficulte 3}}
                <div class="sheet-survivant-titre" title="Action très difficile (4)">{{title}}</div>
                    {{/rollTotal() difficulte 3}}
                
                <div class="sheet-resultat-des">
                    {{#rollGreater() nombre_de 0}}
                        {{#rollGreater() computed::d1 3}}
                        <div class="sheet-value-reussite">{{d1}}</div>
                        {{/rollGreater() computed::d1 3}}
                        {{#^rollGreater() computed::d1 3}}
                        <div class="sheet-value-echec">{{d1}}</div>
                        {{/^rollGreater() computed::d1 3}}
                    {{/rollGreater() nombre_de 0}}
                    {{#rollGreater() nombre_de 1}}
                        {{#rollGreater() computed::d2 3}}
                        <div class="sheet-value-reussite">{{d2}}</div>
                        {{/rollGreater() computed::d2 3}}
                        {{#^rollGreater() computed::d2 3}}
                        <div class="sheet-value-echec">{{d2}}</div>
                        {{/^rollGreater() computed::d2 3}}
                    {{/rollGreater() nombre_de 1}}
                    {{#rollGreater() nombre_de 2}}
                        {{#rollGreater() computed::d3 3}}
                        <div class="sheet-value-reussite">{{d3}}</div>
                        {{/rollGreater() computed::d3 3}}
                        {{#^rollGreater() computed::d3 3}}
                        <div class="sheet-value-echec">{{d3}}</div>
                        {{/^rollGreater() computed::d3 3}}
                    {{/rollGreater() nombre_de 2}}
                    {{#rollGreater() nombre_de 3}}
                        {{#rollGreater() computed::d4 3}}
                        <div class="sheet-value-reussite">{{d4}}</div>
                        {{/rollGreater() computed::d4 3}}
                        {{#^rollGreater() computed::d4 3}}
                        <div class="sheet-value-echec">{{d4}}</div>
                        {{/^rollGreater() computed::d4 3}}
                    {{/rollGreater() nombre_de 3}}
                    {{#rollGreater() nombre_de 4}}
                        {{#rollGreater() computed::d5 3}}
                        <div class="sheet-value-reussite">{{d5}}</div>
                        {{/rollGreater() computed::d5 3}}
                        {{#^rollGreater() computed::d5 3}}
                        <div class="sheet-value-echec">{{d5}}</div>
                        {{/^rollGreater() computed::d5 3}}
                    {{/rollGreater() nombre_de 4}}
                    {{#rollGreater() nombre_de 5}}
                        {{#rollGreater() computed::d6 3}}
                        <div class="sheet-value-reussite">{{d6}}</div>
                        {{/rollGreater() computed::d6 3}}
                        {{#^rollGreater() computed::d6 3}}
                        <div class="sheet-value-echec">{{d6}}</div>
                        {{/^rollGreater() computed::d6 3}}
                    {{/rollGreater() nombre_de 5}}
            <!-- Dés bonus -->
                    {{#rollTotal() computed::relance 1}}
                    <div class="sheet-separateur">/</div>
                    {{/rollTotal() computed::relance 1}}
                    {{#rollGreater() computed::d1 5}}
                        {{#rollGreater() computed::d1bis 3}}
                        <div class="sheet-value-reussite">{{d1bis}}</div>
                        {{/rollGreater() computed::d1bis 3}}
                        {{#^rollGreater() computed::d1bis 3}}
                        <div class="sheet-value-echec">{{d1bis}}</div>
                        {{/^rollGreater() computed::d1bis 3}}
                    {{/rollGreater() computed::d1 5}}
                    {{#rollGreater() computed::d2 5}}
                        {{#rollGreater() computed::d2bis 3}}
                        <div class="sheet-value-reussite">{{d2bis}}</div>
                        {{/rollGreater() computed::d2bis 3}}
                        {{#^rollGreater() computed::d2bis 3}}
                        <div class="sheet-value-echec">{{d2bis}}</div>
                        {{/^rollGreater() computed::d2bis 3}}
                    {{/rollGreater() computed::d2 5}}
                    {{#rollGreater() computed::d3 5}}
                        {{#rollGreater() computed::d3bis 3}}
                        <div class="sheet-value-reussite">{{d3bis}}</div>
                        {{/rollGreater() computed::d3bis 3}}
                        {{#^rollGreater() computed::d3bis 3}}
                        <div class="sheet-value-echec">{{d3bis}}</div>
                        {{/^rollGreater() computed::d3bis 3}}
                    {{/rollGreater() computed::d3 5}}
                    {{#rollGreater() computed::d4 5}}
                        {{#rollGreater() computed::d4bis 3}}
                        <div class="sheet-value-reussite">{{d4bis}}</div>
                        {{/rollGreater() computed::d4bis 3}}
                        {{#^rollGreater() computed::d4bis 3}}
                        <div class="sheet-value-echec">{{d4bis}}</div>
                        {{/^rollGreater() computed::d4bis 3}}
                    {{/rollGreater() computed::d4 5}}
                    {{#rollGreater() computed::d5 5}}
                        {{#rollGreater() computed::d5bis 3}}
                        <div class="sheet-value-reussite">{{d5bis}}</div>
                        {{/rollGreater() computed::d5bis 3}}
                        {{#^rollGreater() computed::d5bis 3}}
                        <div class="sheet-value-echec">{{d5bis}}</div>
                        {{/^rollGreater() computed::d5bis 3}}
                    {{/rollGreater() computed::d5 5}}
                    {{#rollGreater() computed::d6 5}}
                        {{#rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-reussite">{{d6bis}}</div>
                        {{/rollGreater() computed::d6bis 3}}
                        {{#^rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-echec">{{d6bis}}</div>
                        {{/^rollGreater() computed::d6bis 3}}
                    {{/rollGreater() computed::d6 5}}
            <!-- Dé TER -->
                    {{#rollGreater() computed::d1bis 5}}
                        {{#rollGreater() computed::d1ter 3}}
                        <div class="sheet-value-reussite">{{d1ter}}</div>
                        {{/rollGreater() computed::d1ter 3}}
                        {{#^rollGreater() computed::d1ter 3}}
                        <div class="sheet-value-echec">{{d1ter}}</div>
                        {{/^rollGreater() computed::d1ter 3}}
                    {{/rollGreater() computed::d1bis 5}}
                    {{#rollGreater() computed::d2bis 5}}
                        {{#rollGreater() computed::d2ter 3}}
                        <div class="sheet-value-reussite">{{d2ter}}</div>
                        {{/rollGreater() computed::d2ter 3}}
                        {{#^rollGreater() computed::d2ter 3}}
                        <div class="sheet-value-echec">{{d2ter}}</div>
                        {{/^rollGreater() computed::d2ter 3}}
                    {{/rollGreater() computed::d2bis 5}}
                    {{#rollGreater() computed::d3bis 5}}
                        {{#rollGreater() computed::d3ter 3}}
                        <div class="sheet-value-reussite">{{d3ter}}</div>
                        {{/rollGreater() computed::d3ter 3}}
                        {{#^rollGreater() computed::d3ter 3}}
                        <div class="sheet-value-echec">{{d3ter}}</div>
                        {{/^rollGreater() computed::d3ter 3}}
                    {{/rollGreater() computed::d3bis 5}}
                    {{#rollGreater() computed::d4bis 5}}
                        {{#rollGreater() computed::d4ter 3}}
                        <div class="sheet-value-reussite">{{d4ter}}</div>
                        {{/rollGreater() computed::d4ter 3}}
                        {{#^rollGreater() computed::d4ter 3}}
                        <div class="sheet-value-echec">{{d4ter}}</div>
                        {{/^rollGreater() computed::d4ter 3}}
                    {{/rollGreater() computed::d4bis 5}}
                    {{#rollGreater() computed::d5bis 5}}
                        {{#rollGreater() computed::d5ter 3}}
                        <div class="sheet-value-reussite">{{d5ter}}</div>
                        {{/rollGreater() computed::d5ter 3}}
                        {{#^rollGreater() computed::d5ter 3}}
                        <div class="sheet-value-echec">{{d5ter}}</div>
                        {{/^rollGreater() computed::d5ter 3}}
                    {{/rollGreater() computed::d5bis 5}}
                    {{#rollGreater() computed::d6bis 5}}
                        {{#rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-reussite">{{d6ter}}</div>
                        {{/rollGreater() computed::d6bis 3}}
                        {{#^rollGreater() computed::d6bis 3}}
                        <div class="sheet-value-echec">{{d6ter}}</div>
                        {{/^rollGreater() computed::d6bis 3}}
                    {{/rollGreater() computed::d6bis 5}}
                </div>
                {{#echec}}
                    {{#^rollLess() computed::reussite difficulte_reel}}
                        <div class="sheet-desc-reussite1">RÉUSSITE</div>
                        <div class="sheet-desc-adrenaline_gain">Vous ne perdez aucun point d'Adrénaline</div>
                    {{/^rollLess() computed::reussite difficulte_reel}}
                    {{#rollLess() computed::reussite difficulte_reel}}
                        <div class="sheet-desc-echec1">ÉCHEC</div>
                        <div class="sheet-desc-adrenaline_perte">Vous perdez, non pas 1, mais 2 points d'Adrénaline</div>
                    {{/rollLess() computed::reussite difficulte_reel}}
                {{/echec}}
                {{#armes}}
                    {{#rollGreater() computed::reussite 0}}
                        <div class="sheet-desc-reussite1">{{computed::reussite}} POINT(S) DE DÉGÂTS</div>
                        {{#rollTotal() nombre_relance 1}}
                        <div class="sheet-desc-adrenaline_gain">Cette arme permet de <br>relancer 1 dé</div>
                        {{/rollTotal() nombre_relance 1}}
                        {{#rollTotal() nombre_relance 2}}
                        <div class="sheet-desc-adrenaline_gain">Cette arme permet de <br>relancer 2 dés</div>
                        {{/rollTotal() nombre_relance 2}}
                    {{/rollGreater() computed::reussite 0}}
                    {{#^rollGreater() computed::reussite 0}}
                        <div class="sheet-desc-echec1">AUCUN DÉGÂT</div>
                        {{#rollTotal() nombre_relance 1}}
                        <div class="sheet-desc-adrenaline_perte">Cette arme permet de <br>relancer 1 dé</div>
                        {{/rollTotal() nombre_relance 1}}
                        {{#rollTotal() nombre_relance 2}}
                        <div class="sheet-desc-adrenaline_perte">Cette arme permet de <br>relancer 2 dés</div>
                        {{/rollTotal() nombre_relance 2}}
                    {{/^rollGreater() computed::reussite 0}}
                {{/armes}}
                {{#sauvagerie}}
                <div class="sheet-desc">{{desc}}</div>
                {{/sauvagerie}}
            </div>
        </div>
</rolltemplate>
