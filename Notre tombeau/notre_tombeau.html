<!-- ----------------- -->
<!-- Valeurs integrées -->
<!-- ----------------- -->

<!-- --------------------- -->
<!-- Feuille de personnage -->
<!-- --------------------- -->
<div class="feuille">
    <div class="wrapper_feuille">
        <div class="feuille_titre">
            NOTRE TOMBEAU
        </div>
        <div class="feuille_citation">
            "Ceci est le combat du jour et de la nuit...
            <br>
            Je vois de la lumière noire. " <span class="hugo">DERNIERS MOTS DE VICTOR HUGO, 22MAI 1885</span>
        </div>
        <div class="feuille_aptitude">
            <div class="wrapper_aptitude">
                <div class="aptitude_titre1">APTITUDES</div>
                <div class="aptitude_titre2">ACTION</div>
                <div class="aptitude_titre3">NOMBRE DE DÉS À 4 OU +</div>
            </div>
            <div class="wrapper_aptitude" style="margin-top: 15px;">
                <div class="aptitude_1">COURIR</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_courir" min="1" max="6" value="0"></div>
                <div class="aptitude_3">FACILE</div>
                <div class="aptitude_4">RÉUSSITE AUTOMATIQUE</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">ENCAISSER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_encaisser" min="1" max="6" value="0"></div>
                <div class="aptitude_3">RELATIVEMENT FACILE</div>
                <div class="aptitude_4">1</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">ESCALADER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_escalader" min="1" max="6" value="0"></div>
                <div class="aptitude_3">MOYENNE</div>
                <div class="aptitude_4">2</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">FORCER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_forcer" min="1" max="6" value="0"></div>
                <div class="aptitude_3">DIFFICILE</div>
                <div class="aptitude_4">3</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">RÉAGIR</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_reagir" min="1" max="6" value="0"></div>
                <div class="aptitude_3">TRÉS DIFFICILE</div>
                <div class="aptitude_4">4</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">REMARQUER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_remarquer" min="1" max="6" value="0"></div>
                <div class="aptitude_3">IMPOSSIBLE</div>
                <div class="aptitude_4">ÉCHEC AUTOMATIQUE</div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">S'IMPOSER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_imposer" min="1" max="6" value="0"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">SAUTER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_sauter" min="1" max="6" value="0"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">SAVOIR-FAIRE</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_savoir_faire" min="1" max="6" value="0"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">SE BATTRE</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_se_battre" min="1" max="6" value="0"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">SE CALMER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_se_calmer" min="1" max="6" value="0"></div>
            </div>
            <div class="wrapper_aptitude">
                <div class="aptitude_1">VISER</div>
                <div class="aptitude_2"><input type="number" class="aptitudes" name="attr_viser" min="1" max="6" value="0"></div>
            </div>            
        </div>
        <div class="feuille_vie">
            <input type="number" class="vie_adrenaline" name="attr_hp" value="0">
        </div>
        <div class="feuille_vie_titre">
            VIE
        </div>
        <div class="feuille_adrenaline">
            <input type="number" class="vie_adrenaline" name="attr_adrenaline" value="0">
        </div>
        <div class="feuille_adrenaline_titre">
            ADRÉNALINE
        </div>
        <div class="feuille_arme">
            ARMES DE FORTUNE
        </div>
        <div class="feuille_arme_donnees">
            <div class="wrapper_armes" style="margin-top: 15px;">
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_1"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1">1</div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2">0</div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_2"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1">1</div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2">0</div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_3"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1">1</div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2">0</div>
                <div class="armes_fixe3">D)</div>
            </div>
            <div class="wrapper_armes">
                <div class="armes_nom"><input type="text" class="armes" name="attr_arme_4"></div>
                <div class="armes_fixe1">(</div>                
                <div class="armes_d1">1</div>
                <div class="armes_fixe2">D /</div>
                <div class="armes_d2">0</div>
                <div class="armes_fixe3">D)</div>
            </div>
        </div>
        <div class="feuille_sauvagerie">
            SAUVAGERIE
        </div>
        <div class="feuille_sauvagerie_donnees">
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">CARNAGE (2 POINTS)</div>
                <div class="sauvagerie_info">inflige les dommages maximum.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">FRÉNÉSIE (2 POINTS)</div>
                <div class="sauvagerie_info">deux actions consécutives sans contre.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">INSENSIBILITÉ (3 POINTS)</div>
                <div class="sauvagerie_info">ignore la dernière perte de points de Vie.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">FURIE (3 POINTS)</div>
                <div class="sauvagerie_info">deux dés supplémentaires à la prochaine action</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">MISE À MORT (4 POINTS)</div>
                <div class="sauvagerie_info">tue du premier coup ou met KO.</div> 
            </div>
            <div class="wrapper_sauvagerie">
                <div class="sauvagerie_nom">INVULNÉRABILITÉ (X PONTS)</div>
                <div class="sauvagerie_info">regagne autant de Vie que de points d'Adrénaline dépensés.</div> 
            </div>
        </div>
    </div>
    <button type="action" class="retourner_page" name="act_roll_courir">courir</button>

</div>

<!-- -------------------- -->
<!-- ----- SCRIPT ------- -->
<!-- -------------------- -->

<!-- Script Roll aptitudes -->
<script type="text/worker">
    on('clicked:roll_courir', (info) => {
        startRoll("&{template:tombeau} {{title=@{character_name}}} {{d1=[[d6]]}} {{d2=[[d6]]}} {{d3=[[d6]]}} {{d4=[[d6]]}} {{d5=[[d6]]}} {{d6=[[d6]]}} {{nombre_de=[[@{courir}]]}} {{difficulte=[[?{Difficulté de l'action|2} -1]]}} {{reussite=[[0[resultat]]]}}", (results) => {
                 
            let d1 = parseInt(results.results.d1.dice);
            let d2 = parseInt(results.results.d2.dice);
            let d3 = parseInt(results.results.d3.dice);
            let d4 = parseInt(results.results.d4.dice);
            let d5 = parseInt(results.results.d5.dice);
            let d6 = parseInt(results.results.d6.dice);
            let difficulte = parseInt(results.results.difficulte.result);
            let nombre_de = parseInt(results.results.nombre_de.result);
            let reussite_1 = 0;
            let reussite_2 = 0;
            let reussite_3 = 0;
            let reussite_4 = 0;
            let reussite_5 = 0;
            let reussite_6 = 0;
            let computed_d1 = 0;
            let computed_d2 = 0;
            let computed_d3 = 0;
            let computed_d4 = 0;
            let computed_d5 = 0;
            let computed_d6 = 0;

                if (d1 > 3) reussite_1 = 1, computed_d1 = d1;
                if (d2 > 3 && nombre_de >= 2) reussite_2 = 1, computed_d2 = d2;
                if (d3 > 3 && nombre_de >= 3) reussite_3 = 1, computed_d3 = d3;
                if (d4 > 3 && nombre_de >= 4) reussite_4 = 1, computed_d4 = d4;
                if (d5 > 3 && nombre_de >= 5) reussite_5 = 1, computed_d5 = d5;
                if (d6 > 3 && nombre_de >= 6) reussite_6 = 1, computed_d6 = d6; 

            let reussite_totale = reussite_1 + reussite_2 + reussite_3 + reussite_4 + reussite_5 + reussite_6;
              
console.log("nombre_de");console.log(nombre_de);
console.log("d1"); console.log(d1);
console.log("reussite_1");console.log(reussite_1);
console.log("d2"); console.log(d2);
console.log("reussite_2");console.log(reussite_2);
console.log("d3"); console.log(d3);
console.log("reussite_3");console.log(reussite_3);
console.log("d4"); console.log(d4);
console.log("reussite_4");console.log(reussite_4);
console.log("d5"); console.log(d5);
console.log("reussite_5");console.log(reussite_5);
console.log("d6"); console.log(d6);
console.log("reussite_6"); console.log(reussite_6);
console.log("reussite_totale");console.log(reussite_totale);

                finishRoll(
                    results.rollId,
                    {
                        d1: computed_d1,
                        d2: computed_d2,
                        d3: computed_d3,
                        d4: computed_d4,
                        d5: computed_d5,
                        d6: computed_d6,
                        reussite: reussite_totale
                    }
                    );
                });
            });
</script>


<!-- --------------------------- -->
<!-- ----- ROLL TEMPLATE ------- -->
<!-- --------------------------- -->

<rolltemplate class="sheet-rolltemplate-tombeau">
    <div class="ecart"></div>
    <span class="shadow_roll">
        <div class="sheet-container">
            <div class="sheet-content">
                <div class="sheet-survivant-titre">patient</div>
                <div class="sheet-survivant-valeur">{{title}}</div>
                    {{#rollTotal() difficulte 0}}
                <div class="sheet-posologie" title="Action relativement facile (1)">Résultats</div>
                    {{/rollTotal() difficulte 0}}
                    {{#rollTotal() difficulte 1}}
                <div class="sheet-posologie" title="Action moyenne (2)">Résultats</div>
                    {{/rollTotal() difficulte 1}}
                    {{#rollTotal() difficulte 2}}
                <div class="sheet-posologie" title="Action difficile (3)">Résultats</div>
                    {{/rollTotal() difficulte 2}}
                    {{#rollTotal() difficulte 3}}
                <div class="sheet-posologie" title="Action très difficile (4)">Résultats</div>
                    {{/rollTotal() difficulte 3}}
                
                <div class="sheet-resultat-des">
                    {{#rollGreater() nombre_de 0}}
                        {{#rollGreater() computed::d1 3}}
                        <div class="sheet-value-reussite">{{d1}}</div>
                        {{/rollGreater() computed::d1 3}}
                        {{#^rollGreater() computed::d1 3}}
                        <div class="sheet-value-echec">{{d1}}</div>
                        {{/^rollGreater() computed::d1 3}}
                    {{/rollGreater() nombre_de 0}}
                    {{#rollGreater() nombre_de 1}}
                        {{#rollGreater() computed::d2 3}}
                        <div class="sheet-value-reussite">{{d2}}</div>
                        {{/rollGreater() computed::d2 3}}
                        {{#^rollGreater() computed::d2 3}}
                        <div class="sheet-value-echec">{{d2}}</div>
                        {{/^rollGreater() computed::d2 3}}
                    {{/rollGreater() nombre_de 1}}
                    {{#rollGreater() nombre_de 2}}
                        {{#rollGreater() computed::d3 3}}
                        <div class="sheet-value-reussite">{{d3}}</div>
                        {{/rollGreater() computed::d3 3}}
                        {{#^rollGreater() computed::d3 3}}
                        <div class="sheet-value-echec">{{d3}}</div>
                        {{/^rollGreater() computed::d3 3}}
                    {{/rollGreater() nombre_de 2}}
                    {{#rollGreater() nombre_de 3}}
                        {{#rollGreater() computed::d4 3}}
                        <div class="sheet-value-reussite">{{d4}}</div>
                        {{/rollGreater() computed::d4 3}}
                        {{#^rollGreater() computed::d4 3}}
                        <div class="sheet-value-echec">{{d4}}</div>
                        {{/^rollGreater() computed::d4 3}}
                    {{/rollGreater() nombre_de 3}}
                    {{#rollGreater() nombre_de 4}}
                        {{#rollGreater() computed::d5 3}}
                        <div class="sheet-value-reussite">{{d5}}</div>
                        {{/rollGreater() computed::d5 3}}
                        {{#^rollGreater() computed::d5 3}}
                        <div class="sheet-value-echec">{{d5}}</div>
                        {{/^rollGreater() computed::d5 3}}
                    {{/rollGreater() nombre_de 4}}
                    {{#rollGreater() nombre_de 5}}
                        {{#rollGreater() computed::d6 3}}
                        <div class="sheet-value-reussite">{{d6}}</div>
                        {{/rollGreater() computed::d6 3}}
                        {{#^rollGreater() computed::d6 3}}
                        <div class="sheet-value-echec">{{d6}}</div>
                        {{/^rollGreater() computed::d6 3}}
                    {{/rollGreater() nombre_de 5}}
                </div>

                {{#^rollLess() computed::reussite difficulte}}
                <div class="sheet-desc-reussite1">Réussite</div>
                {{/^rollLess() computed::reussite difficulte}}
                {{#rollLess() computed::reussite difficulte}}
                <div class="sheet-desc-echec1">Échec</div>
                {{/rollLess() computed::reussite difficulte}}
            </div>
        </div>
    </span>
</rolltemplate>




