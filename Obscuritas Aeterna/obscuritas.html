<input type="hidden" name="attr_page" class="choix_page" value="0">
<input type="hidden" name="attr_malus_total_dexterite" value="0">
<input type="hidden" name="attr_malus_total_athletisme" value="0">
<input type="hidden" name="attr_malus_total_combat_cac" value="0">
<input type="hidden" name="attr_malus_total_combat_puglilat" value="0">
<input type="hidden" name="attr_malus_total_combat_distance" value="0">
<input type="hidden" name="attr_malus_total_discretion" value="0">
<input type="hidden" name="attr_malus_total_esquive" value="0">
<input type="hidden" name="attr_malus_total_esquive" value="0">

<!-- <div class="menu">
    
    <button type="action" name="act_0" class="button0" style="margin-left: 2px;box-shadow: 0px 1px 6px 0px var(--color_ombre_button);">Personnage</button>
    <button type="action" name="act_1" class="button1">Équipement</button>
    <button type="action" name="act_4" class="button4">Carnet de route</button>
    <button type="action" name="act_2" class="button2">Parcours de vie</button>
    <button type="action" name="act_3" class="button3">Personnes marquantes</button>	
    <button type="action" name="act_roll-sens" class="button_sens_carte" title="Cliquez pour savoir dans quel sens est la carte.">Oracle</button>
	<button type="action" name="act_6" class="button6">Fatalité</button>
    <button type="action" name="act_5" class="button5">PNJ</button>
</div> -->


<div class="page1">

    <!-- <input type="number" class="input_carac" name="attr_force_reel" value="15" min="15" max="99">
    <br>
    <input type="number" class="input_carac" name="attr_dexterite_reel" value="15" min="15" max="99">
    <br>
    <input type="number" class="input_carac" name="attr_constitution_reel" value="15" min="15" max="99">
    <br>
    <input type="number" class="input_carac" name="attr_intelligence_reel" value="15" min="15" max="99">
    <br>
    <input type="number" class="input_carac" name="attr_charisme_reel" value="15" min="15" max="99">
    <br>
    <input type="number" class="input_carac" name="attr_volonte_reel" value="15" min="15" max="99">
    <br> -->

    <!-- Information personnage -->
    <div class="personnage">
        <div class="wrapper_page_personnage">
            <input type="hidden" name="attr_page" class="choix_page" value="0">
            <!-- INFORMATIONS -->
            <div class="zone_info">
                INFORMATIONS PERSONNAGE<br>
                <div class="wrapper_zone_info">
                    <span>Nom</span>:
                    <input name="attr_character_name" type="text" spellcheck="false" class="input_dotted" />
                    <span>Age</span>:<input name="attr_age" type="text" spellcheck="false" class="input_dotted" />
                    <span>Profession</span>:
                    <input name="attr_profession" type="text" spellcheck="false" class="input_dotted" />
                </div>
            </div>  
            <!-- CARACTERISTIQUES -->

            <div class="zone_caracteristiques">
                CARACTERISTIQUES<br>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-force">FORCE</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_force" value="15" min="15" max="99"></div>
                </div>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-dexterite">DEXTÉRITÉ</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_dexterite" value="15" min="15" max="99"></div>
                </div>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-constitution">CONSTITUTION</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_constitution" value="15" min="15" max="99"></div>
                </div>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-intelligence">INTELLIGENCE</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_intelligence" value="15" min="15" max="99"></div>
                </div>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-charisme">CHARISME</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_charisme" value="15" min="15" max="99"></div>
                </div>
                <div class="wrapper_zone_caracteristiques">
                    <div class="caracteristiques_titre">
                        <button type="action" class="button_texte" name="act_roll-volonte">VOLONTÉ</button>
                    </div>
                    <div class="caracteristiques_valeur"><input type="number" class="input_carac" name="attr_volonte" value="15" min="15" max="99"></div>
                </div>
            </div>
 
            <!-- PDV / MAGIE / SM -->
            <div class="zone_derives">
                PDV - PDM - SM<br>
                <div class="wrapper_zone_derives">
                    <div class="derives_titre">
                        <button type="action" class="button_texte" name="act_roll-pdv">POINTS DE VIE</button>
                    </div>
                    <div class="derives_valeur">
                        <input type="number" class="input_carac" name="attr_pdv" value="0" min="0" max="99">
                        sur <input type="number" class="input_carac_lock" name="attr_pdv_maxi" value="1" min="1" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_derives">
                    <div class="derives_titre">
                        <button type="action" class="button_texte" name="act_roll-pdm">POINTS DE MAGIE</button>
                    </div>
                    <div class="derives_valeur">
                        <input type="number" class="input_carac" name="attr_pdm" value="1" min="1" max="99">
                        sur <input type="number" class="input_carac_lock" name="attr_pdm_maxi" value="1" min="1" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_derives">
                    <div class="derives_titre">
                        <button type="action" class="button_texte" name="act_roll-sm">SANTÉ MENTALE</button>
                    </div>
                    <div class="derives_valeur">
                        <input type="number" class="input_carac" name="attr_sm" value="1" min="1" max="99">
                        sur <input type="number" class="input_carac_lock" name="attr_sm_maxi" value="1" min="1" max="99" readonly />
                    </div>
                </div>
                
                <div class="wrapper_zone_derives"></div>
                <div class="wrapper_zone_derives">
                    <div class="derives_titre">
                        MALUS ESQUIVE 
                    </div>
                    <div class="derives_valeur">
                        <input type="number" class="input_carac_lock" name="attr_malus_esquive_final" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_derives">
                    <div class="derives_titre">
                        BONUS PARADE 
                    </div>
                    <div class="derives_valeur">
                        <input type="number" class="input_carac_lock" name="attr_bonus_parade_final" readonly />
                    </div>
                </div>
            </div>          

            <!-- TALENTS -->
            <div class="zone_talents_1">
                TALENTS<br>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme-force">Athlétisme (Force)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_athletisme" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_athletisme_force" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme-dex">Athlétisme (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_athletisme" value="0" min="0" max="99" style="visibility: hidden;">
                        <input type="number" class="input_carac_lock" name="attr_athletisme_dexterite" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-baratin-charisme">Baratin (Charisme)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_baratin" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_baratin_charisme" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-baratin-force">Baratin (Force)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_baratin" value="0" min="0" max="99" style="visibility: hidden;">
                        <input type="number" class="input_carac_lock" name="attr_baratin_force" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-bibliotheque">Bibliothèque (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_bibliotheque" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_bibliotheque" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-chercher">Chercher (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_chercher" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_chercher" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-cac-dex">Combat CaC (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_combat_cac" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_combat_cac_dexterite" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-cac-force">Combat CaC (Force)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_combat_cac" value="0" min="0" max="99" style="visibility: hidden;">
                        <input type="number" class="input_carac_lock" name="attr_combat_cac_force" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-pugilat">Combat Pugilat (Force)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_combat_pugilat" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_combat_pugilat" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-distance">Combat Distance (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_combat_distance" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_combat_distance" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-discretion">Discrétion (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_discretion" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_discretion" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-endurance">Endurance (Constitution)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_endurance" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_endurance" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-esquive">Esquive (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_esquive" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_esquive" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-ancienne-intel">Langue ancienne (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_langue_ancienne" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_langue_ancienne_intelligence" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-ancienne-volonte">Langue ancienne (Volonté)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_langue_ancienne" value="0" min="0" max="99" style="visibility: hidden;">
                        <input type="number" class="input_carac_lock" name="attr_langue_ancienne_volonte" value="0" min="0" max="99" readonly />
                    </div>
                </div>
            </div>
            <div class="zone_talents_2">
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Langue (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_langue" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_langue" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Médecine (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_medecine" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_medecine" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Métier (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_metier" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_metier_intelligence" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Métier (Volonté)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_metier" value="0" min="0" max="99" style="visibility: hidden;">
                        <input type="number" class="input_carac_lock" name="attr_metier_volonte" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Perception (Volonté)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_perception" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_perception" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Psychologie (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_psychologie" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_psychologie" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Sciences (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_science" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_science" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Sciences occultes (Volonté)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_sciences_occultes" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_sciences_occultes" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Survie (Intelligence)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_survie" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_survie" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <button type="action" class="button_texte" name="act_roll-athletisme">Vigilance (Dextérité)</button>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac" name="attr_stat_vigilance" value="0" min="0" max="99">
                        <input type="number" class="input_carac_lock" name="attr_vigilance" value="0" min="0" max="99" readonly />
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <select class="choix_custom" name="attr_custom_stat_1">
                            <option value="0" selected="selected"></option>
                            <option value="1">Athlétisme</option>
                            <option value="2">Baratin</option>
                            <option value="3">Bibliothèque</option>
                            <option value="4">Chercher</option>
                            <option value="5">Combat CaC</option>
                            <option value="6">Combat Pugilat</option>
                            <option value="7">Combat Distance</option>
                            <option value="8">Discrétion</option>
                            <option value="9">Endurance</option>
                            <option value="10">Esquive</option>
                            <option value="11">Langue ancienne</option>
                            <option value="12">Langue</option>
                            <option value="13">Médecine</option>
                            <option value="14">Métier</option>
                            <option value="15">Perception</option>
                            <option value="16">Psychologie</option>
                            <option value="17">Sciences</option>
                            <option value="18">Sciences occultes</option>
                            <option value="19">Survie</option>
                            <option value="20">Vigilance</option>
                        </select>

                        <select class="choix_custom" name="attr_custom_comp_1">
                            <option value="0" selected="selected"></option>
                            <option value="1">Force</option>
                            <option value="2">Dextérité</option>
                            <option value="3">Constitution</option>
                            <option value="4">Intelligence</option>
                            <option value="5">Charisme</option>
                            <option value="6">Volonté</option>
                        </select>
                    </div>
                    <div class="talents_valeur">
                        <!-- Pour contôle si besoin -->
                        <!-- <input type="number" class="input_carac_lock" name="attr_stat_1" value="0" min="0" max="99" readonly />
                        <input type="number" class="input_carac_lock" name="attr_comp_1" value="0" min="0" max="99" readonly /> -->
                        <input type="number" class="input_carac_lock" name="attr_custom_1" value="0" min="0" max="99" readonly />
                        <button type="roll">ROLL</button>
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <select class="choix_custom" name="attr_custom_stat_2">
                            <option value="0" selected="selected"></option>
                            <option value="1">Athlétisme</option>
                            <option value="2">Baratin</option>
                            <option value="3">Bibliothèque</option>
                            <option value="4">Chercher</option>
                            <option value="5">Combat CaC</option>
                            <option value="6">Combat Pugilat</option>
                            <option value="7">Combat Distance</option>
                            <option value="8">Discrétion</option>
                            <option value="9">Endurance</option>
                            <option value="10">Esquive</option>
                            <option value="11">Langue ancienne</option>
                            <option value="12">Langue</option>
                            <option value="13">Médecine</option>
                            <option value="14">Métier</option>
                            <option value="15">Perception</option>
                            <option value="16">Psychologie</option>
                            <option value="17">Sciences</option>
                            <option value="18">Sciences occultes</option>
                            <option value="19">Survie</option>
                            <option value="20">Vigilance</option>
                        </select>

                        <select class="choix_custom" name="attr_custom_comp_2">
                            <option value="0" selected="selected"></option>
                            <option value="1">Force</option>
                            <option value="2">Dextérité</option>
                            <option value="3">Constitution</option>
                            <option value="4">Intelligence</option>
                            <option value="5">Charisme</option>
                            <option value="6">Volonté</option>
                        </select>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac_lock" name="attr_custom_2" value="0" min="0" max="99" readonly />
                        <button type="roll">ROLL</button>
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <select class="choix_custom" name="attr_custom_stat_3">
                            <option value="0" selected="selected"></option>
                            <option value="1">Athlétisme</option>
                            <option value="2">Baratin</option>
                            <option value="3">Bibliothèque</option>
                            <option value="4">Chercher</option>
                            <option value="5">Combat CaC</option>
                            <option value="6">Combat Pugilat</option>
                            <option value="7">Combat Distance</option>
                            <option value="8">Discrétion</option>
                            <option value="9">Endurance</option>
                            <option value="10">Esquive</option>
                            <option value="11">Langue ancienne</option>
                            <option value="12">Langue</option>
                            <option value="13">Médecine</option>
                            <option value="14">Métier</option>
                            <option value="15">Perception</option>
                            <option value="16">Psychologie</option>
                            <option value="17">Sciences</option>
                            <option value="18">Sciences occultes</option>
                            <option value="19">Survie</option>
                            <option value="20">Vigilance</option>
                        </select>

                        <select class="choix_custom" name="attr_custom_comp_3">
                            <option value="0" selected="selected"></option>
                            <option value="1">Force</option>
                            <option value="2">Dextérité</option>
                            <option value="3">Constitution</option>
                            <option value="4">Intelligence</option>
                            <option value="5">Charisme</option>
                            <option value="6">Volonté</option>
                        </select>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac_lock" name="attr_custom_3" value="0" min="0" max="99" readonly />
                        <button type="roll">ROLL</button>
                    </div>
                </div>
                <div class="wrapper_zone_talents">
                    <div class="talents_titre">
                        <select class="choix_custom" name="attr_custom_stat_4">
                            <option value="0" selected="selected"></option>
                            <option value="1">Athlétisme</option>
                            <option value="2">Baratin</option>
                            <option value="3">Bibliothèque</option>
                            <option value="4">Chercher</option>
                            <option value="5">Combat CaC</option>
                            <option value="6">Combat Pugilat</option>
                            <option value="7">Combat Distance</option>
                            <option value="8">Discrétion</option>
                            <option value="9">Endurance</option>
                            <option value="10">Esquive</option>
                            <option value="11">Langue ancienne</option>
                            <option value="12">Langue</option>
                            <option value="13">Médecine</option>
                            <option value="14">Métier</option>
                            <option value="15">Perception</option>
                            <option value="16">Psychologie</option>
                            <option value="17">Sciences</option>
                            <option value="18">Sciences occultes</option>
                            <option value="19">Survie</option>
                            <option value="20">Vigilance</option>
                        </select>

                        <select class="choix_custom" name="attr_custom_comp_4">
                            <option value="0" selected="selected"></option>
                            <option value="1">Force</option>
                            <option value="2">Dextérité</option>
                            <option value="3">Constitution</option>
                            <option value="4">Intelligence</option>
                            <option value="5">Charisme</option>
                            <option value="6">Volonté</option>
                        </select>
                    </div>
                    <div class="talents_valeur">
                        <input type="number" class="input_carac_lock" name="attr_custom_4" value="0" min="0" max="99" readonly />
                        <button type="roll">ROLL</button>
                    </div>
                </div>
            </div>
            <!-- ARMEMENT -->
            <div class="zone_armes">ARMES<br>
                <div class="wrapper_zone_armes" style="grid-auto-rows: 40px;line-height: 12px;">
                    <div class="armes_type">Type</div>
                    <div class="armes_degats">Dégâts</div>
                    <div class="armes_portee">Portée</div>
                    <div class="armes_effet">Effets</div>
                    <div class="armes_notes">Notes</div>
                    <div class="armes_roll">Jet</div>
                </div>
                <div class="wrapper_zone_armes">
                    <div class="armes_type">
                        <select class="choix_custom" name="attr_armes_nom_1">
                            <option value="0" selected="selected"></option>
                            <option value="1">Dague</option>
                            <option value="2">Épée courte</option>
                            <option value="3">Épée longue</option>
                            <option value="4">Hache</option>
                            <option value="5">Lance</option>
                            <option value="6">Masse d'arme</option>
                            <option value="7">Arc court</option>
                            <option value="8">Arc long</option>
                            <option value="9">Arbalète</option>
                        </select>
                    </div>
                    <div class="armes_degats">
                        <input name="attr_armes_degats_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_portee">
                        <input name="attr_armes_portee_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_effet">
                        <input name="attr_armes_effet_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_notes">
                        <input name="attr_armes_notes_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_roll">
                        roll                        
                    </div>
                </div>
                <div class="wrapper_zone_armes">
                    <div class="armes_type">
                        <select class="choix_custom" name="attr_armes_nom_2">
                            <option value="0" selected="selected"></option>
                            <option value="1">Dague</option>
                            <option value="2">Épée courte</option>
                            <option value="3">Épée longue</option>
                            <option value="4">Hache</option>
                            <option value="5">Lance</option>
                            <option value="6">Masse d'arme</option>
                            <option value="7">Arc court</option>
                            <option value="8">Arc long</option>
                            <option value="9">Arbalète</option>
                        </select>
                    </div>
                    <div class="armes_degats">
                        <input name="attr_armes_degats_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_portee">
                        <input name="attr_armes_portee_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_effet">
                        <input name="attr_armes_effet_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_notes">
                        <input name="attr_armes_notes_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_roll">
                        roll                        
                    </div>
                </div>
                <div class="wrapper_zone_armes">
                    <div class="armes_type">
                        <select class="choix_custom" name="attr_armes_nom_3">
                            <option value="0" selected="selected"></option>
                            <option value="1">Dague</option>
                            <option value="2">Épée courte</option>
                            <option value="3">Épée longue</option>
                            <option value="4">Hache</option>
                            <option value="5">Lance</option>
                            <option value="6">Masse d'arme</option>
                            <option value="7">Arc court</option>
                            <option value="8">Arc long</option>
                            <option value="9">Arbalète</option>
                        </select>
                    </div>
                    <div class="armes_degats">
                        <input name="attr_armes_degats_3" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_portee">
                        <input name="attr_armes_portee_3" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_effet">
                        <input name="attr_armes_effet_3" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_notes">
                        <input name="attr_armes_notes_3" type="text" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armes_roll">
                        roll                        
                    </div>
                </div>
            </div>

            <!-- ARMURES -->
            <div class="zone_armures">ARMURES<br>
                <div class="wrapper_zone_armures" style="grid-auto-rows: 40px;line-height: 12px;">
                    <div class="armures_equipee"></div>
                    <div class="armures_type">TYPE</div>
                    <div class="armures_encaissement">ENCAISSEMENT</div>
                    <div class="armures_dexterite">MALUS DEX</div>
                    <div class="armures_athletisme">MALUS ATHLE</div>
                    <div class="armures_cac">MALUS COMBAT CAC</div>
                    <div class="armures_pugilat">MALUS PUGILAT</div>
                    <div class="armures_distance">MALUS COMBAT DISTANCE</div>
                    <div class="armures_discretion">MALUS DISCRETION</div>
                    <div class="armures_esquive">MALUS ESQUIVE</div>
                    <div class="armures_notes">NOTES</div>
                </div>
                <div class="wrapper_zone_armures">
                    <div class="armures_equipee">
                        <input type="checkbox" name="attr_armures_equipe_1" value="1" id="armure1">
					    <label for="armure1"></label>
                    </div>
                    <div class="armures_type">
                        <select class="choix_custom" name="attr_armures_nom_1">
                            <option value="0" selected="selected"></option>
                            <option value="1">Vêtements renforcés</option>
                            <option value="2">Cuir bouilli</option>
                            <option value="3">Armures de mailles</option>
                            <option value="4">Armure de plaque</option>
                        </select>
                    </div>
                    <div class="armures_encaissement">
                        <input name="attr_armures_encaissement_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_dexterite">
                        <input name="attr_armures_malus_dexterite_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_athletisme">
                        <input name="attr_armures_malus_athletisme_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_cac">
                        <input name="attr_armures_malus_combat_cac_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_pugilat">
                        <input name="attr_armures_malus_combat_pugilat_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_distance">
                        <input name="attr_armures_malus_combat_distance_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_discretion">
                        <input name="attr_armures_malus_discretion_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_esquive">
                        <input name="attr_armures_malus_esquive_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_notes">
                        <input name="attr_armures_notes_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                </div>
                <div class="wrapper_zone_armures">
                    <div class="armures_equipee">
                        <input type="checkbox" name="attr_armures_equipe_2" value="1" id="armure2">
					    <label for="armure2"></label>
                    </div>
                    <div class="armures_type">
                        <select class="choix_custom" name="attr_armures_nom_2">
                            <option value="0" selected="selected"></option>
                            <option value="1">Vêtements renforcés</option>
                            <option value="2">Cuir bouilli</option>
                            <option value="3">Armures de mailles</option>
                            <option value="4">Armure de plaque</option>
                        </select>
                    </div>
                    <div class="armures_encaissement">
                        <input name="attr_armures_encaissement_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_dexterite">
                        <input name="attr_armures_malus_dexterite_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_athletisme">
                        <input name="attr_armures_malus_athletisme_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_cac">
                        <input name="attr_armures_malus_combat_cac_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_pugilat">
                        <input name="attr_armures_malus_combat_pugilat_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_distance">
                        <input name="attr_armures_malus_combat_distance_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_discretion">
                        <input name="attr_armures_malus_discretion_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_esquive">
                        <input name="attr_armures_malus_esquive_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_notes">
                        <input name="attr_armures_notes_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                </div>
                <div class="wrapper_zone_armures">
                    <div class="armures_equipee">
                        <input type="checkbox" name="attr_armures_equipe_3" value="1" id="armure3">
					    <label for="armure3"></label>
                    </div>
                    <div class="armures_type">
                        <select class="choix_custom" name="attr_armures_nom_3">
                            <option value="0" selected="selected"></option>
                            <option value="1">Vêtements renforcés</option>
                            <option value="2">Cuir bouilli</option>
                            <option value="3">Armures de mailles</option>
                            <option value="4">Armure de plaque</option>
                        </select>
                    </div>
                    <div class="armures_encaissement">
                        <input name="attr_armures_encaissement_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_dexterite">
                        <input name="attr_armures_malus_dexterite_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_athletisme">
                        <input name="attr_armures_malus_athletisme_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_cac">
                        <input name="attr_armures_malus_combat_cac_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_pugilat">
                        <input name="attr_armures_malus_combat_pugilat_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_distance">
                        <input name="attr_armures_malus_combat_distance_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_discretion">
                        <input name="attr_armures_malus_discretion_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_esquive">
                        <input name="attr_armures_malus_esquive_3" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="armures_notes">
                        <input name="attr_armures_notes_3" type="text" spellcheck="false" class="input_dotted">
                    </div>
                </div>
            </div>

            <!-- BOUCLIERS -->
            <div class="zone_boucliers">BOUCLIERS<br>
                <div class="wrapper_zone_boucliers" style="grid-auto-rows: 40px;line-height: 12px;">
                    <div class="boucliers_equipee">
                    </div>
                    <div class="boucliers_type">TYPE</div>
                    <div class="boucliers_parade">BONUS PARADE</div>
                    <div class="boucliers_esquive">MALUS ESQUIVE</div>
                    <div class="boucliers_notes">NOTES</div>
                </div>
                <div class="wrapper_zone_boucliers">
                    <div class="boucliers_equipee">
                        <input type="checkbox" name="attr_boucliers_equipe_1" value="1" id="bouclier1">
                        <label for="bouclier1"></label>
                    </div>
                    <div class="boucliers_type">
                        <select class="choix_custom" name="attr_boucliers_nom_1">
                            <option value="0" selected="selected"></option>
                            <option value="1">Bouclier rond</option>
                            <option value="2">Pavois</option>
                        </select>
                    </div>
                    <div class="boucliers_parade">
                        <input name="attr_boucliers_bonus_parade_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="boucliers_esquive">
                        <input name="attr_boucliers_malus_esquive_1" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="boucliers_notes">
                        <input name="attr_boucliers_notes_1" type="text" spellcheck="false" class="input_dotted">
                    </div>
                </div>
                <div class="wrapper_zone_boucliers">
                    <div class="boucliers_equipee">
                        <input type="checkbox" name="attr_boucliers_equipe_2" value="1" id="bouclier2">
                        <label for="bouclier2"></label>
                    </div>
                    <div class="boucliers_type">
                        <select class="choix_custom" name="attr_boucliers_nom_2">
                            <option value="0" selected="selected"></option>
                            <option value="1">Bouclier rond</option>
                            <option value="2">Pavois</option>
                        </select>
                    </div>
                    <div class="boucliers_parade">
                        <input name="attr_boucliers_bonus_parade_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="boucliers_esquive">
                        <input name="attr_boucliers_malus_esquive_2" type="number" spellcheck="false" class="input_dotted">
                    </div>
                    <div class="boucliers_notes">
                        <input name="attr_boucliers_notes_2" type="text" spellcheck="false" class="input_dotted">
                    </div>
                </div>
            </div>


            <!-- AURA -->

            <!-- INVENTAIRE -->
            
            <!-- NOTES -->
            
            <!-- EXPERIENCE -->
    </div>  
</div>

<div class="systeme">
    <div class="go_feuille">
        <!-- <button type="action" name="act_0" class="button_go" title="Retour à la feuille...">U</button> -->
    </div>
</div>







<!-- ------------------------------------------ -->
<!--              ROLL TEMPLATE                 -->
<!-- ------------------------------------------ -->

<rolltemplate class="sheet-rolltemplate-thanatos">
	<div class="sheet-toper"></div>
    {{#sens}}
        <div class="sheet-rolltemplate-thanatos-background sheet-rolltemplate-thanatos-center">
			<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-color">
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-header">
					{{title}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-subheader" style="padding-top: 0px;margin-top: 0px;">
					{{#rollTotal() des 1}}
					<span style="font-size: 30px;">Carte à <br>L'ENDROIT</span>
					{{/rollTotal() des 1}}
					{{#^rollTotal() des 1}}
					<span style="font-size: 30px;">Carte à <br>L'ENVERS</span>
					{{/^rollTotal() des 1}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-rolltemplate-thanatos-center sheet-template-thanatos-rappel">
				</div>
			</div>
        </div>
    {{/sens}}
	{{#initiative}}
        <div class="sheet-rolltemplate-thanatos-background sheet-rolltemplate-thanatos-center">
			<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-color">
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-header">
					{{title}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-subheader">
					{{result}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-rolltemplate-thanatos sheet-template-thanatos-texte">
					{{subheader}}
				</div>
			</div>
        </div>
    {{/initiative}}
	{{#annonce_armes}}
        <div class="sheet-rolltemplate-thanatos-background sheet-rolltemplate-thanatos-center">
			<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-color">
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-header">
					{{title}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-content">
				{{#allprops() title subheader annonce_armes}}
				  <div class="sheet-key">{{key}}</div>
				  <div class="sheet-value">{{value}}</div>
				{{/allprops() title subheader annonce_armes}}
				</div>
			</div>
        </div>
    {{/annonce_armes}}
	{{#annonce_artillerie}}
        <div class="sheet-rolltemplate-thanatos-background sheet-rolltemplate-thanatos-center">
			<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-color">
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-header">
					{{title}}
				</div>
				<div class="sheet-separateur"></div>
				<div class="sheet-content">
				{{#allprops() title subheader annonce_artillerie}}
				  <div class="sheet-key">{{key}}</div>
				  <div class="sheet-value">{{value}}</div>
				{{/allprops() title subheader annonce_artillerie}}
				</div>
			</div>
        </div>
    {{/annonce_artillerie}}
    {{#jet}}
        <div class="sheet-rolltemplate-thanatos-background sheet-rolltemplate-thanatos-center">
			<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-color">
		
				<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-header">
					{{title}} <span style="font-size: 17px;">({{stat}})</span>
					<br><span style="font-size: 16px; font-weight: normal;">{{subheader}}</span>
				</div>
				<div class="sheet-separateur"></div>
					{{#rollGreater() des computed::roll}}
						<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-subheader-echec">{{des}}</div>
						<div class="sheet-rolltemplate-thanatos sheet-template-thanatos-texte-echec">Échec </div>
					{{/rollGreater() des computed::roll}}
					{{#^rollGreater() des computed::roll}}
						<div class="sheet-rolltemplate-thanatos-center sheet-rolltemplate-thanatos-subheader-reussite">{{des}}</div>
						<div class="sheet-rolltemplate-thanatos sheet-template-thanatos-texte-reussite">Reussite
                            {{#^rollTotal() computed::degre 0}}
                            <br><span style="font-size:20px !important;">avec {{computed::degre}} degrés</span>
                            {{/^rollTotal() computed::degre 0}}
                        </div>
					{{/^rollGreater() des computed::roll}}
				
				<div class="sheet-separateur"></div>
				<div class="sheet-rolltemplate-thanatos-center sheet-template-thanatos-rappel">
					Modificateur ({{mod}}) | Blessure ({{blessure}})
					{{#jet_agi}}
					<br> Malus d'armure ({{malusarmure}})
					{{/jet_agi}}
				</div>
			</div>
        </div>
    {{/jet}}
	<div class="sheet-bottom"></div>
</rolltemplate>



<!-- ------------------------------------------ -->
<!--                  SCRIPT                    -->
<!-- ------------------------------------------ -->

<!-- Custom Attributs  -->
<script type="text/worker">
    on("change:custom_stat_1 change:custom_stat_2 change:custom_stat_3 change:custom_stat_4 change:custom_comp_1 change:custom_comp_2 change:custom_comp_3 change:custom_comp_4", function() {

        getAttrs(["custom_stat_1", "custom_stat_2", "custom_stat_3", "custom_stat_4", "custom_comp_1", "custom_comp_2", "custom_comp_3", "custom_comp_4", "force", "dexterite", "constitution", "intelligence", "charisme", "volonte", "stat_athletisme", "stat_baratin", "stat_bibliotheque", "stat_chercher", "stat_combat_cac", "stat_combat_pugilat", "stat_combat_distance", "stat_discretion", "stat_endurance", "stat_esquive", "stat_langue_ancienne", "stat_langue", "stat_medecine", "stat_metier", "stat_perception", "stat_psychologie", "stat_science", "stat_sciences_occultes", "stat_survie", "stat_vigilance"], function(values) {
            let custom_stat_1 = parseInt(values["custom_stat_1"]) || 0;
            let custom_stat_2 = parseInt(values["custom_stat_2"]) || 0;
            let custom_stat_3 = parseInt(values["custom_stat_3"]) || 0;
            let custom_stat_4 = parseInt(values["custom_stat_4"]) || 0;
            let custom_comp_1 = parseInt(values["custom_comp_1"]) || 0;
            let custom_comp_2 = parseInt(values["custom_comp_2"]) || 0;
            let custom_comp_3 = parseInt(values["custom_comp_3"]) || 0;
            let custom_comp_4 = parseInt(values["custom_comp_4"]) || 0;
            let force = parseInt(values["force"]) || 0;
            let dexterite = parseInt(values["dexterite"]) || 0;
            let constitution = parseInt(values["constitution"]) || 0;
            let intelligence = parseInt(values["intelligence"]) || 0;
            let charisme = parseInt(values["charisme"]) || 0;
            let volonte = parseInt(values["volonte"]) || 0;
            let stat_athletisme = parseInt(values["stat_athletisme"]) || 0;
            let stat_baratin = parseInt(values["stat_baratin"]) || 0;
            let stat_bibliotheque = parseInt(values["stat_bibliotheque"]) || 0;
            let stat_chercher = parseInt(values["stat_chercher"]) || 0;
            let stat_combat_cac = parseInt(values["stat_combat_cac"]) || 0;
            let stat_combat_pugilat = parseInt(values["stat_combat_pugilat"]) || 0;
            let stat_combat_distance = parseInt(values["stat_combat_distance"]) || 0;
            let stat_discretion = parseInt(values["stat_discretion"]) || 0;
            let stat_endurance = parseInt(values["stat_endurance"]) || 0;
            let stat_esquive = parseInt(values["stat_esquive"]) || 0;
            let stat_langue_ancienne = parseInt(values["stat_langue_ancienne"]) || 0;
            let stat_langue = parseInt(values["stat_langue"]) || 0;
            let stat_medecine = parseInt(values["stat_medecine"]) || 0;
            let stat_metier = parseInt(values["stat_metier"]) || 0;
            let stat_perception = parseInt(values["stat_perception"]) || 0;
            let stat_psychologie = parseInt(values["stat_psychologie"]) || 0;
            let stat_science = parseInt(values["stat_science"]) || 0;
            let stat_sciences_occultes = parseInt(values["stat_sciences_occultes"]) || 0;
            let stat_survie = parseInt(values["stat_survie"]) || 0;
            let stat_vigilance = parseInt(values["stat_vigilance"]) || 0;

            if      (custom_stat_1 == 1) stat_1 = stat_athletisme;
            else if (custom_stat_1 == 2) stat_1 = stat_baratin;
            else if (custom_stat_1 == 3) stat_1 = stat_bibliotheque;
            else if (custom_stat_1 == 4) stat_1 = stat_chercher;
            else if (custom_stat_1 == 5) stat_1 = stat_combat_cac;
            else if (custom_stat_1 == 6) stat_1 = stat_combat_pugilat;
            else if (custom_stat_1 == 7) stat_1 = stat_combat_distance;
            else if (custom_stat_1 == 8) stat_1 = stat_discretion;
            else if (custom_stat_1 == 9) stat_1 = stat_endurance;
            else if (custom_stat_1 == 10) stat_1 = stat_esquive;
            else if (custom_stat_1 == 11) stat_1 = stat_langue_ancienne;
            else if (custom_stat_1 == 12) stat_1 = stat_langue;
            else if (custom_stat_1 == 13) stat_1 = stat_medecine;
            else if (custom_stat_1 == 14) stat_1 = stat_metier;
            else if (custom_stat_1 == 15) stat_1 = stat_perception;
            else if (custom_stat_1 == 16) stat_1 = stat_psychologie;
            else if (custom_stat_1 == 17) stat_1 = stat_science;
            else if (custom_stat_1 == 18) stat_1 = stat_sciences_occultes;
            else if (custom_stat_1 == 19) stat_1 = stat_survie;
            else if (custom_stat_1 == 20) stat_1 = stat_vigilance;
            else stat_1 = 0;

            if      (custom_stat_2 == 1) stat_2 = stat_athletisme;
            else if (custom_stat_2 == 2) stat_2 = stat_baratin;
            else if (custom_stat_2 == 3) stat_2 = stat_bibliotheque;
            else if (custom_stat_2 == 4) stat_2 = stat_chercher;
            else if (custom_stat_2 == 5) stat_2 = stat_combat_cac;
            else if (custom_stat_2 == 6) stat_2 = stat_combat_pugilat;
            else if (custom_stat_2 == 7) stat_2 = stat_combat_distance;
            else if (custom_stat_2 == 8) stat_2 = stat_discretion;
            else if (custom_stat_2 == 9) stat_2 = stat_endurance;
            else if (custom_stat_2 == 10) stat_2 = stat_esquive;
            else if (custom_stat_2 == 11) stat_2 = stat_langue_ancienne;
            else if (custom_stat_2 == 12) stat_2 = stat_langue;
            else if (custom_stat_2 == 13) stat_2 = stat_medecine;
            else if (custom_stat_2 == 14) stat_2 = stat_metier;
            else if (custom_stat_2 == 15) stat_2 = stat_perception;
            else if (custom_stat_2 == 16) stat_2 = stat_psychologie;
            else if (custom_stat_2 == 17) stat_2 = stat_science;
            else if (custom_stat_2 == 18) stat_2 = stat_sciences_occultes;
            else if (custom_stat_2 == 19) stat_2 = stat_survie;
            else if (custom_stat_2 == 20) stat_2 = stat_vigilance;
            else stat_2 = 0;

            if      (custom_stat_3 == 1) stat_3 = stat_athletisme;
            else if (custom_stat_3 == 2) stat_3 = stat_baratin;
            else if (custom_stat_3 == 3) stat_3 = stat_bibliotheque;
            else if (custom_stat_3 == 4) stat_3 = stat_chercher;
            else if (custom_stat_3 == 5) stat_3 = stat_combat_cac;
            else if (custom_stat_3 == 6) stat_3 = stat_combat_pugilat;
            else if (custom_stat_3 == 7) stat_3 = stat_combat_distance;
            else if (custom_stat_3 == 8) stat_3 = stat_discretion;
            else if (custom_stat_3 == 9) stat_3 = stat_endurance;
            else if (custom_stat_3 == 10) stat_3 = stat_esquive;
            else if (custom_stat_3 == 11) stat_3 = stat_langue_ancienne;
            else if (custom_stat_3 == 12) stat_3 = stat_langue;
            else if (custom_stat_3 == 13) stat_3 = stat_medecine;
            else if (custom_stat_3 == 14) stat_3 = stat_metier;
            else if (custom_stat_3 == 15) stat_3 = stat_perception;
            else if (custom_stat_3 == 16) stat_3 = stat_psychologie;
            else if (custom_stat_3 == 17) stat_3 = stat_science;
            else if (custom_stat_3 == 18) stat_3 = stat_sciences_occultes;
            else if (custom_stat_3 == 19) stat_3 = stat_survie;
            else if (custom_stat_3 == 20) stat_3 = stat_vigilance;
            else stat_3 = 0;

            if      (custom_stat_4 == 1) stat_4 = stat_athletisme;
            else if (custom_stat_4 == 2) stat_4 = stat_baratin;
            else if (custom_stat_4 == 3) stat_4 = stat_bibliotheque;
            else if (custom_stat_4 == 4) stat_4 = stat_chercher;
            else if (custom_stat_4 == 5) stat_4 = stat_combat_cac;
            else if (custom_stat_4 == 6) stat_4 = stat_combat_pugilat;
            else if (custom_stat_4 == 7) stat_4 = stat_combat_distance;
            else if (custom_stat_4 == 8) stat_4 = stat_discretion;
            else if (custom_stat_4 == 9) stat_4 = stat_endurance;
            else if (custom_stat_4 == 10) stat_4 = stat_esquive;
            else if (custom_stat_4 == 11) stat_4 = stat_langue_ancienne;
            else if (custom_stat_4 == 12) stat_4 = stat_langue;
            else if (custom_stat_4 == 13) stat_4 = stat_medecine;
            else if (custom_stat_4 == 14) stat_4 = stat_metier;
            else if (custom_stat_4 == 15) stat_4 = stat_perception;
            else if (custom_stat_4 == 16) stat_4 = stat_psychologie;
            else if (custom_stat_4 == 17) stat_4 = stat_science;
            else if (custom_stat_4 == 18) stat_4 = stat_sciences_occultes;
            else if (custom_stat_4 == 19) stat_4 = stat_survie;
            else if (custom_stat_4 == 20) stat_4 = stat_vigilance;
            else stat_4 = 0;

            if      (custom_comp_1 == 1) comp_1 = force;
            else if (custom_comp_1 == 2) comp_1 = dexterite;
            else if (custom_comp_1 == 3) comp_1 = constitution;
            else if (custom_comp_1 == 4) comp_1 = intelligence;
            else if (custom_comp_1 == 5) comp_1 = charisme;
            else if (custom_comp_1 == 6) comp_1 = volonte;
            else comp_1 = 0;

            if      (custom_comp_2 == 1) comp_2 = force;
            else if (custom_comp_2 == 2) comp_2 = dexterite;
            else if (custom_comp_2 == 3) comp_2 = constitution;
            else if (custom_comp_2 == 4) comp_2 = intelligence;
            else if (custom_comp_2 == 5) comp_2 = charisme;
            else if (custom_comp_2 == 6) comp_2 = volonte;
            else comp_2 = 0;

            if      (custom_comp_3 == 1) comp_3 = force;
            else if (custom_comp_3 == 2) comp_3 = dexterite;
            else if (custom_comp_3 == 3) comp_3 = constitution;
            else if (custom_comp_3 == 4) comp_3 = intelligence;
            else if (custom_comp_3 == 5) comp_3 = charisme;
            else if (custom_comp_3 == 6) comp_3 = volonte;
            else comp_3 = 0;

            if      (custom_comp_4 == 1) comp_4 = force;
            else if (custom_comp_4 == 2) comp_4 = dexterite;
            else if (custom_comp_4 == 3) comp_4 = constitution;
            else if (custom_comp_4 == 4) comp_4 = intelligence;
            else if (custom_comp_4 == 5) comp_4 = charisme;
            else if (custom_comp_4 == 6) comp_4 = volonte;
            else comp_4 = 0;

            console.log("stat_1:", stat_1);
            console.log("stat_2:", stat_2);
            console.log("stat_3:", stat_3);
            console.log("stat_4:", stat_4);
            
            setAttrs({
                "stat_1": stat_1,
                "stat_2": stat_2,
                "stat_3": stat_3,
                "stat_4": stat_4,
                "comp_1": comp_1,
                "comp_2": comp_2,
                "comp_3": comp_3,
                "comp_4": comp_4
            });
        });
    });
</script>

<!-- Roll modifier / MAJ Stats  -->
<script type="text/worker"> 

    on("sheet:opened", function(eventInfo){
        setAttrs({
            rollmodifier: "?{Modificateur|0|+10|+20|+30|+40|+50|-10|-20|-30|-40|-50}",
        });
    });	

     
    on("change:stat_1 change:stat_2 change:stat_3 change:stat_4 change:comp_1 change:comp_2 change:comp_3 change:comp_4 change:force change:dexterite change:constitution change:intelligence change:charisme change:volonte change:stat_athletisme change:stat_baratin change:stat_bibliotheque change:stat_chercher change:stat_combat_cac change:stat_combat_pugilat change:stat_combat_distance change:stat_discretion change:stat_endurance change:stat_esquive change:stat_langue_ancienne change:stat_langue change:stat_medecine change:stat_metier change:stat_perception change:stat_psychologie change:stat_science change:stat_sciences_occultes change:stat_survie change:stat_vigilance ", function() {

        getAttrs(["stat_1", "stat_2", "stat_3", "stat_4", "comp_1", "comp_2", "comp_3", "comp_4", "force", "dexterite", "constitution", "intelligence", "charisme", "volonte", "stat_athletisme", "stat_baratin", "stat_bibliotheque", "stat_chercher", "stat_combat_cac", "stat_combat_pugilat", "stat_combat_distance", "stat_discretion", "stat_endurance", "stat_esquive", "stat_langue_ancienne", "stat_langue", "stat_medecine", "stat_metier", "stat_perception", "stat_psychologie", "stat_science", "stat_sciences_occultes", "stat_survie", "stat_vigilance"], function(values) {
            let stat_1 = parseInt(values["stat_1"]) || 0;
            let stat_2 = parseInt(values["stat_2"]) || 0;
            let stat_3 = parseInt(values["stat_3"]) || 0;
            let stat_4 = parseInt(values["stat_4"]) || 0;
            let comp_1 = parseInt(values["comp_1"]) || 0;
            let comp_2 = parseInt(values["comp_2"]) || 0;
            let comp_3 = parseInt(values["comp_3"]) || 0;
            let comp_4 = parseInt(values["comp_4"]) || 0;            
            let force = parseInt(values["force"]) || 0;
            let dexterite = parseInt(values["dexterite"]) || 0;
            let constitution = parseInt(values["constitution"]) || 0;
            let intelligence = parseInt(values["intelligence"]) || 0;
            let charisme = parseInt(values["charisme"]) || 0;
            let volonte = parseInt(values["volonte"]) || 0;
            let stat_athletisme = parseInt(values["stat_athletisme"]) || 0;
            let stat_baratin = parseInt(values["stat_baratin"]) || 0;
            let stat_bibliotheque = parseInt(values["stat_bibliotheque"]) || 0;
            let stat_chercher = parseInt(values["stat_chercher"]) || 0;
            let stat_combat_cac = parseInt(values["stat_combat_cac"]) || 0;
            let stat_combat_pugilat = parseInt(values["stat_combat_pugilat"]) || 0;
            let stat_combat_distance = parseInt(values["stat_combat_distance"]) || 0;
            let stat_discretion = parseInt(values["stat_discretion"]) || 0;
            let stat_endurance = parseInt(values["stat_endurance"]) || 0;
            let stat_esquive = parseInt(values["stat_esquive"]) || 0;
            let stat_langue_ancienne = parseInt(values["stat_langue_ancienne"]) || 0;
            let stat_langue = parseInt(values["stat_langue"]) || 0;
            let stat_medecine = parseInt(values["stat_medecine"]) || 0;
            let stat_metier = parseInt(values["stat_metier"]) || 0;
            let stat_perception = parseInt(values["stat_perception"]) || 0;
            let stat_psychologie = parseInt(values["stat_psychologie"]) || 0;
            let stat_science = parseInt(values["stat_science"]) || 0;
            let stat_sciences_occultes = parseInt(values["stat_sciences_occultes"]) || 0;
            let stat_survie = parseInt(values["stat_survie"]) || 0;
            let stat_vigilance = parseInt(values["stat_vigilance"]) || 0;
        
            let pdv_maxi = Math.floor(constitution / 5);
            let pdm_maxi = Math.floor(volonte / 5);
            let sm_maxi = 100-intelligence;
            let mouvement = Math.floor(dexterite/10)*2;

            let athletisme_force = Math.floor(stat_athletisme + (force/2));
            let athletisme_dexterite = Math.floor(stat_athletisme + (dexterite/2));
            let baratin_charisme = Math.floor(stat_baratin + (charisme/2));
            let baratin_force = Math.floor(stat_baratin + (force/2));
            let bibliotheque = Math.floor(stat_bibliotheque + (intelligence/2));
            let chercher = Math.floor(stat_chercher + (intelligence/2));
            let combat_cac_dexterite = Math.floor(stat_combat_cac + (dexterite/2));
            let combat_cac_force = Math.floor(stat_combat_cac + (force/2));
            let combat_pugilat = Math.floor(stat_combat_pugilat + (dexterite/2));
            let combat_distance = Math.floor(stat_combat_distance + (dexterite/2));
            let discretion = Math.floor(stat_discretion + (dexterite/2));
            let endurance = Math.floor(stat_endurance + (constitution/2));
            let esquive = Math.floor(stat_esquive + (dexterite/2));
            let langue_ancienne_intelligence = Math.floor(stat_langue_ancienne + (intelligence/2));
            let langue_ancienne_volonte = Math.floor(stat_langue_ancienne + (volonte/2));
            let langue = Math.floor(stat_langue + (intelligence/2));
            let medecine = Math.floor(stat_medecine + (intelligence/2));
            let metier_intelligence = Math.floor(stat_metier + (intelligence/2));
            let metier_volonte = Math.floor(stat_metier + (volonte/2));
            let perception = Math.floor(stat_perception + (volonte/2));
            let psychologie = Math.floor(stat_psychologie + (intelligence/2));
            let science = Math.floor(stat_science + (intelligence/2));
            let sciences_occultes = Math.floor(stat_sciences_occultes + (volonte/2));
            let survie = Math.floor(stat_survie + (intelligence/2));
            let vigilance = Math.floor(stat_vigilance + (dexterite/2));
            let custom_1 = Math.floor(stat_1 + (comp_1/2));
            let custom_2 = Math.floor(stat_2 + (comp_2/2));
            let custom_3 = Math.floor(stat_3 + (comp_3/2));
            let custom_4 = Math.floor(stat_4 + (comp_4/2));

            let force_reel = force;
            let dexterite_reel = dexterite;
            let constitution_reel = constitution;
            let intelligence_reel = intelligence;
            let charisme_reel = charisme;
            let volonte_reel = volonte;



            setAttrs({
                "pdv_maxi": pdv_maxi,
                "pdm_maxi": pdm_maxi,
                "sm_maxi": sm_maxi,
                "mouvement": mouvement,
                "athletisme_force": athletisme_force,
                "athletisme_dexterite": athletisme_dexterite,
                "baratin_charisme": baratin_charisme,
                "baratin_force": baratin_force,
                "bibliotheque": bibliotheque,
                "chercher": chercher,
                "combat_cac_dexterite": combat_cac_dexterite,
                "combat_cac_force": combat_cac_force,
                "combat_pugilat": combat_pugilat,
                "combat_distance": combat_distance,
                "discretion": discretion,
                "endurance": endurance,
                "esquive": esquive,
                "langue_ancienne_intelligence": langue_ancienne_intelligence,
                "langue_ancienne_volonte": langue_ancienne_volonte,
                "langue": langue,
                "medecine": medecine,
                "metier_intelligence": metier_intelligence,
                "metier_volonte": metier_volonte,
                "perception": perception,
                "psychologie": psychologie,
                "science": science,
                "sciences_occultes": sciences_occultes,
                "survie": survie,
                "vigilance": vigilance,
                "custom_1": custom_1,
                "custom_2": custom_2,
                "custom_3": custom_3,
                "custom_4": custom_4,
                "force_reel": force_reel,
                "dexterite_reel": dexterite_reel,
                "constitution_reel": constitution_reel,
                "intelligence_reel": intelligence_reel,
                "charisme_reel": charisme_reel,
                "volonte_reel": volonte_reel
            });
        });
    });
</script>

<!-- MAJ equipement -->
<script type="text/worker">
    on("change:armes_nom_1 change:armes_nom_2 change:armes_nom_3", function (eventInfo) {
        const changedAttribute = eventInfo.sourceAttribute; // Attribut déclencheur

        if (changedAttribute.startsWith("armes_nom_")) {
            getAttrs([changedAttribute], function (values) {
                const armeNom = parseInt(values[changedAttribute]) || 0;
                let arme = {
                    designation: "",
                    type: "",
                    degats: "",
                    portee: "",
                    effet: "",
                    notes: ""
                };

                // Détermine les valeurs en fonction du arme sélectionné
                switch (armeNom) {
                    // Dague
                    case 1:
                        arme = {
                            designation: "Dague",
                            type: "Dague",
                            degats: "1D4",
                            portee: "",
                            effet: "Peut s'utiliser sur la Dextérité",
                            notes: "Arme légère, discrète, facile à dissimuler"
                        };
                        break;
                    // Épée courte
                    case 2:
                        arme = {
                            designation: "Épée courte",
                            type: "Épée courte",
                            degats: "1D6",
                            portee: "",
                            effet: "",
                            notes: "Maniable, souvent utilisée par les mercenaires"
                        };
                        break;
                    // Épée longue
                    case 3:
                        arme = {
                            designation: "Épée longue",
                            type: "Épée longue",
                            degats: "1D6 +1",
                            portee: "",
                            effet: "Ignore 1 point d'armure",
                            notes: "Arme polyvalente, symbole de noblesse"
                        };
                        break;
                    // Hache
                    case 4:
                        arme = {
                            designation: "Hache",
                            type: "Hache",
                            degats: "1D8",
                            portee: "",
                            effet: "Sur une attaque critique, brise un bouclier",
                            notes: "Lourde mais puissante, idéale pour briser les boucliers"
                        };
                        break;
                    // Lance
                    case 5:
                        arme = {
                            designation: "Lance",
                            type: "Lance",
                            degats: "1D6",
                            portee: "2m",
                            effet: "",
                            notes: "Bonne portée, souvent utilisée à cheval"
                        };
                        break;
                    // Masse d'armes
                    case 6:
                        arme = {
                            designation: "Masse d'armes",
                            type: "Masse d'armes",
                            degats: "1D6",
                            portee: "",
                            effet: "Ignore 2 points d'armure",
                            notes: "Effet dévastateur contre les armures lourdes"
                        };
                        break;
                    // Arc court
                    case 7:
                        arme = {
                            designation: "Arc court",
                            type: "Arc court",
                            degats: "1D6",
                            portee: "20m",
                            effet: "",
                            notes: "Arme commune des chasseurs et éclaireurs"
                        };
                        break;
                    // Arc long
                    case 8:
                        arme = {
                            designation: "Arc long",
                            type: "Arc long",
                            degats: "1D6 +1",
                            portee: "30m",
                            effet: "",
                            notes: "Arme des archers expérimentés"
                        };
                        break;
                    // Arbalète
                    case 9:
                        arme = {
                            designation: "Arbalète",
                            type: "Arbalète",
                            degats: "1D8",
                            portee: "40m",
                            effet: "Ignore 3 points d'armure",
                            notes: "Ignorant une partie de l’armure, mais longue à recharger (1action simple)"
                        };
                        break;
                }

                // Détermine l'index de l'attribut modifié (ex. "1", "2", ou "3")
                const num = changedAttribute.match(/\d+/)[0];

                // Met à jour uniquement les champs liés à l'attribut modifié
                const updates = {};
                updates[`armes_designation_${num}`] = arme.designation;
                updates[`armes_type_${num}`] = arme.type;
                updates[`armes_degats_${num}`] = arme.degats;
                updates[`armes_portee_${num}`] = arme.portee;
                updates[`armes_effet_${num}`] = arme.effet;
                updates[`armes_notes_${num}`] = arme.notes;

                setAttrs(updates);
            });
        }
    });

    on("change:armures_nom_1 change:armures_nom_2 change:armures_nom_3", function (eventInfo) {
        const changedAttribute = eventInfo.sourceAttribute; // Attribut déclencheur

        if (changedAttribute.startsWith("armures_nom_")) {
            getAttrs([changedAttribute], function (values) {
                const armureNom = parseInt(values[changedAttribute]) || 0;
                let armure = {
                    designation: "",
                    type: "",
                    encaissement: "",
                    malus_dexterite: "",
                    malus_athletisme: "",
                    malus_combat_cac: "",
                    malus_combat_pugilat: "",
                    malus_combat_distance: "",
                    malus_discretion: "",
                    malus_esquive: "",
                    notes: ""
                };

                // Détermine les valeurs en fonction de l'armure sélectionnée
                switch (armureNom) {
                    // Vetements renforcés
                    case 1:
                        armure = {
                            designation: "Vêtements renforcés",
                            type: "Vêtements renforcés",
                            encaissement: "1",
                            malus_dexterite: "0",
                            malus_athletisme: "0",
                            malus_combat_cac: "0",
                            malus_combat_pugilat: "0",
                            malus_combat_distance: "0",
                            malus_discretion: "0",
                            malus_esquive: "0",
                            notes: "Peu encombrant, protection minimale"
                        };
                        break;
                    // Cuir bouilli
                    case 2:
                        armure = {
                            designation: "Cuir bouilli",
                            type: "Cuir bouilli",
                            encaissement: "2",
                            malus_dexterite: "5",
                            malus_athletisme: "0",
                            malus_combat_cac: "0",
                            malus_combat_pugilat: "0",
                            malus_combat_distance: "0",
                            malus_discretion: "0",
                            malus_esquive: "0",
                            notes: "Couramment utilisé par les chasseurs"
                        };
                        break;
                    // Armure de mailles
                    case 3:
                        armure = {
                            designation: "Armure de maille",
                            type: "Armure de maille",
                            encaissement: "4",
                            malus_dexterite: "10",
                            malus_athletisme: "5",
                            malus_combat_cac: "2",
                            malus_combat_pugilat: "5",
                            malus_combat_distance: "5",
                            malus_discretion: "5",
                            malus_esquive: "5",
                            notes: "Équilibre entre protection et mobilité"
                        };
                        break;
                    // Armure de plaque
                    case 4:
                        armure = {
                            designation: "Armure de plaques",
                            type: "Armure de plaques",
                            encaissement: "6",
                            malus_dexterite: "20",
                            malus_athletisme: "10",
                            malus_combat_cac: "5",
                            malus_combat_pugilat: "10",
                            malus_combat_distance: "10",
                            malus_discretion: "10",
                            malus_esquive: "10",
                            notes: "Lourde, mais excellente protection"
                        };
                        break;
                }

                // Détermine l'index de l'attribut modifié (ex. "1", "2", ou "3")
                const num = changedAttribute.match(/\d+/)[0];

                // Met à jour uniquement les champs liés à l'attribut modifié
                const updates = {};
                updates[`armures_designation_${num}`] = armure.designation;
                updates[`armures_type_${num}`] = armure.type;
                updates[`armures_encaissement_${num}`] = armure.encaissement;
                updates[`armures_malus_dexterite_${num}`] = armure.malus_dexterite;
                updates[`armures_malus_athletisme_${num}`] = armure.malus_athletisme;
                updates[`armures_malus_combat_cac_${num}`] = armure.malus_combat_cac;
                updates[`armures_malus_combat_pugilat_${num}`] = armure.malus_combat_pugilat;
                updates[`armures_malus_combat_distance_${num}`] = armure.malus_combat_distance;
                updates[`armures_malus_discretion_${num}`] = armure.malus_discretion;
                updates[`armures_malus_esquive_${num}`] = armure.malus_esquive;
                updates[`armures_notes_${num}`] = armure.notes;

                setAttrs(updates);
            });
        }
    });

    on("change:boucliers_nom_1 change:boucliers_nom_2", function (eventInfo) {
        const changedAttribute = eventInfo.sourceAttribute; // Attribut déclencheur

        if (changedAttribute.startsWith("boucliers_nom_")) {
            getAttrs([changedAttribute], function (values) {
                const bouclierNom = parseInt(values[changedAttribute]) || 0;
                let bouclier = {
                    designation: "",
                    type: "",
                    bonus_parade: "",
                    malus_esquive: "",
                    notes: ""
                };

                // Détermine les valeurs en fonction du bouclier sélectionné
                switch (bouclierNom) {
                    // Bouclier rond
                    case 1:
                        bouclier = {
                            designation: "Bouclier rond",
                            type: "Bouclier rond",
                            bonus_parade: "1",
                            malus_esquive: "5",
                            notes: "Facile à manier, améliore la défense"
                        };
                        break;
                    // Pavois
                    case 2:
                        bouclier = {
                            designation: "Pavois",
                            type: "Pavois",
                            bonus_parade: "2",
                            malus_esquive: "10",
                            notes: "Idéal pour tenir une position défensive"
                        };
                        break;
                }

                // Détermine l'index de l'attribut modifié (ex. "1" ou "2")
                const num = changedAttribute.match(/\d+/)[0];

                // Met à jour uniquement les champs liés à l'attribut modifié
                const updates = {};
                updates[`boucliers_designation_${num}`] = bouclier.designation;
                updates[`boucliers_type_${num}`] = bouclier.type;
                updates[`boucliers_bonus_parade_${num}`] = bouclier.bonus_parade;
                updates[`boucliers_malus_esquive_${num}`] = bouclier.malus_esquive;
                updates[`boucliers_notes_${num}`] = bouclier.notes;

                setAttrs(updates);
            });
        }
    });

    on("change:armures_nom_1 change:armures_nom_2 change:armures_nom_3 change:armures_equipe_1 change:armures_equipe_2 change:armures_equipe_3 change:armures_encaissement_1 change:armures_malus_athletisme_1 change:armures_malus_combat_cac_1 change:armures_malus_combat_pugilat_1 change:armures_malus_combat_pugilat_1 change:armures_malus_combat_distance_1 change:armures_malus_discretion_1 change:armures_malus_esquive_1 change:armures_encaissement_2 change:armures_malus_athletisme_2 change:armures_malus_combat_cac_2 change:armures_malus_combat_pugilat_2 change:armures_malus_combat_pugilat_2 change:armures_malus_combat_distance_2 change:armures_malus_discretion_2 change:armures_malus_esquive_2 change:armures_encaissement_3 change:armures_malus_athletisme_3 change:armures_malus_combat_cac_3 change:armures_malus_combat_pugilat_3 change:armures_malus_combat_pugilat_3 change:armures_malus_combat_distance_3 change:armures_malus_discretion_3 change:armures_malus_esquive_3", function() {

        getAttrs(["armures_encaissement_1", "armures_malus_dexterite_1", "armures_malus_athletisme_1", "armures_malus_combat_cac_1", "armures_malus_combat_pugilat_1", "armures_malus_combat_distance_1", "armures_malus_discretion_1", "armures_malus_esquive_1", "armures_encaissement_2", "armures_malus_dexterite_2", "armures_malus_athletisme_2", "armures_malus_combat_cac_2", "armures_malus_combat_pugilat_2", "armures_malus_combat_distance_2", "armures_malus_discretion_2", "armures_malus_esquive_2","armures_encaissement_3", "armures_malus_dexterite_3", "armures_malus_athletisme_3", "armures_malus_combat_cac_3", "armures_malus_combat_pugilat_3", "armures_malus_combat_distance_3", "armures_malus_discretion_3", "armures_malus_esquive_3", "armures_equipe_1", "armures_equipe_2", "armures_equipe_3"], function(values) {
            let armures_encaissement_1 = parseInt(values["armures_encaissement_1"]) || 0;
            let armures_malus_dexterite_1 = parseInt(values["armures_malus_dexterite_1"]) || 0;
            let armures_malus_athletisme_1 = parseInt(values["armures_malus_athletisme_1"]) || 0;
            let armures_malus_combat_cac_1 = parseInt(values["armures_malus_combat_cac_1"]) || 0;
            let armures_malus_combat_pugilat_1 = parseInt(values["armures_malus_combat_pugilat_1"]) || 0;
            let armures_malus_combat_distance_1 = parseInt(values["armures_malus_combat_distance_1"]) || 0;
            let armures_malus_discretion_1 = parseInt(values["armures_malus_discretion_1"]) || 0;
            let armures_malus_esquive_1 = parseInt(values["armures_malus_esquive_1"]) || 0;
            let armures_equipe_1 = parseInt(values["armures_equipe_1"]) || 0;

            let armures_encaissement_2 = parseInt(values["armures_encaissement_2"]) || 0;
            let armures_malus_dexterite_2 = parseInt(values["armures_malus_dexterite_2"]) || 0;
            let armures_malus_athletisme_2 = parseInt(values["armures_malus_athletisme_2"]) || 0;
            let armures_malus_combat_cac_2 = parseInt(values["armures_malus_combat_cac_2"]) || 0;
            let armures_malus_combat_pugilat_2 = parseInt(values["armures_malus_combat_pugilat_2"]) || 0;
            let armures_malus_combat_distance_2 = parseInt(values["armures_malus_combat_distance_2"]) || 0;
            let armures_malus_discretion_2 = parseInt(values["armures_malus_discretion_2"]) || 0;
            let armures_malus_esquive_2 = parseInt(values["armures_malus_esquive_2"]) || 0;
            let armures_equipe_2 = parseInt(values["armures_equipe_2"]) || 0;

            let armures_encaissement_3 = parseInt(values["armures_encaissement_3"]) || 0;
            let armures_malus_dexterite_3 = parseInt(values["armures_malus_dexterite_3"]) || 0;
            let armures_malus_athletisme_3 = parseInt(values["armures_malus_athletisme_3"]) || 0;
            let armures_malus_combat_cac_3 = parseInt(values["armures_malus_combat_cac_3"]) || 0;
            let armures_malus_combat_pugilat_3 = parseInt(values["armures_malus_combat_pugilat_3"]) || 0;
            let armures_malus_combat_distance_3 = parseInt(values["armures_malus_combat_distance_3"]) || 0;
            let armures_malus_discretion_3 = parseInt(values["armures_malus_discretion_3"]) || 0;
            let armures_malus_esquive_3 = parseInt(values["armures_malus_esquive_3"]) || 0;
            let armures_equipe_3 = parseInt(values["armures_equipe_3"]) || 0;
            

            if (armures_equipe_1 == 1) 
                total_armures_encaissement = armures_encaissement_1, 
                total_armures_malus_dexterite = armures_malus_dexterite_1,
                total_armures_malus_athletisme = armures_malus_athletisme_1,
                total_armures_malus_combat_cac = armures_malus_combat_cac_1,
                total_armures_malus_combat_pugilat = armures_malus_combat_pugilat_1,
                total_armures_malus_combat_distance = armures_malus_combat_distance_1,
                total_armures_malus_discretion = armures_malus_discretion_1,
                total_armures_malus_esquive = armures_malus_esquive_1;

            else if (armures_equipe_2 == 1) 
                total_armures_encaissement = armures_encaissement_2, 
                total_armures_malus_dexterite = armures_malus_dexterite_2,
                total_armures_malus_athletisme = armures_malus_athletisme_2,
                total_armures_malus_combat_cac = armures_malus_combat_cac_2,
                total_armures_malus_combat_pugilat = armures_malus_combat_pugilat_2,
                total_armures_malus_combat_distance = armures_malus_combat_distance_2,
                total_armures_malus_discretion = armures_malus_discretion_2,
                total_armures_malus_esquive = armures_malus_esquive_2;

            else if (armures_equipe_3 == 1) 
                total_armures_encaissement = armures_encaissement_3, 
                total_armures_malus_dexterite = armures_malus_dexterite_3,
                total_armures_malus_athletisme = armures_malus_athletisme_3,
                total_armures_malus_combat_cac = armures_malus_combat_cac_3,
                total_armures_malus_combat_pugilat = armures_malus_combat_pugilat_3,
                total_armures_malus_combat_distance = armures_malus_combat_distance_3,
                total_armures_malus_discretion = armures_malus_discretion_3,
                total_armures_malus_esquive = armures_malus_esquive_3;

            else             
            total_armures_encaissement = 0, 
            total_armures_malus_dexterite = 0,
            total_armures_malus_athletisme = 0,
            total_armures_malus_combat_cac = 0,
            total_armures_malus_combat_pugilat = 0,
            total_armures_malus_combat_distance = 0,
            total_armures_malus_discretion = 0,
            total_armures_malus_esquive = 0;
            
            total_armures_malus_demi_dexterite = Math.floor(total_armures_malus_dexterite/2);
            
            setAttrs({
                "total_armures_encaissement": total_armures_encaissement,
                "total_armures_malus_dexterite": total_armures_malus_dexterite,
                "total_armures_malus_demi_dexterite": total_armures_malus_demi_dexterite,
                "total_armures_malus_athletisme": total_armures_malus_athletisme,
                "total_armures_malus_combat_cac": total_armures_malus_combat_cac,
                "total_armures_malus_combat_pugilat": total_armures_malus_combat_pugilat,
                "total_armures_malus_combat_distance": total_armures_malus_combat_distance,
                "total_armures_malus_discretion": total_armures_malus_discretion,
                "total_armures_malus_esquive": total_armures_malus_esquive

            });
        });
    });


    on("change:boucliers_nom_1 change:boucliers_nom_2 change:boucliers_equipe_1 change:boucliers_equipe_2 change:boucliers_bonus_parade_1 change:boucliers_bonus_parade_2 change:boucliers_malus_esquive_1 change:boucliers_malus_esquive_2", function() {

        getAttrs(["boucliers_equipe_1", "boucliers_equipe_2", "boucliers_bonus_parade_1", "boucliers_bonus_parade_2", "boucliers_malus_esquive_1", "boucliers_malus_esquive_2"], function(values) {

            let boucliers_equipe_1 = parseInt(values["boucliers_equipe_1"]) || 0;
            let boucliers_equipe_2 = parseInt(values["boucliers_equipe_2"]) || 0;
            let boucliers_bonus_parade_1 = parseInt(values["boucliers_bonus_parade_1"]) || 0;
            let boucliers_bonus_parade_2 = parseInt(values["boucliers_bonus_parade_2"]) || 0;
            let boucliers_malus_esquive_1 = parseInt(values["boucliers_malus_esquive_1"]) || 0;
            let boucliers_malus_esquive_2 = parseInt(values["boucliers_malus_esquive_2"]) || 0;
            

            if (boucliers_equipe_1 == 1) 
                total_boucliers_bonus_parade = boucliers_bonus_parade_1,
                total_boucliers_malus_esquive = boucliers_malus_esquive_1;

            else if (boucliers_equipe_2 == 1) 
                total_boucliers_bonus_parade = boucliers_bonus_parade_2,
                total_boucliers_malus_esquive = boucliers_malus_esquive_2;

            else             
            total_boucliers_bonus_parade = 0, 
            total_boucliers_malus_esquive = 0;
            
            
            setAttrs({
                "total_boucliers_bonus_parade": total_boucliers_bonus_parade,
                "total_boucliers_malus_esquive": total_boucliers_malus_esquive
            });
        });
    });

    on("change:total_boucliers_bonus_parade change:total_boucliers_malus_esquive change:total_armures_malus_esquive", function() {

        getAttrs(["total_boucliers_bonus_parade", "total_boucliers_malus_esquive", "total_armures_malus_esquive"], function(values) {

            let total_boucliers_bonus_parade = parseInt(values["total_boucliers_bonus_parade"]) || 0;
            let total_boucliers_malus_esquive = parseInt(values["total_boucliers_malus_esquive"]) || 0;
            let total_armures_malus_esquive = parseInt(values["total_armures_malus_esquive"]) || 0;
            let bonus_parade_final = total_boucliers_bonus_parade;
            let malus_esquive_final = total_boucliers_malus_esquive + total_armures_malus_esquive;
            
            
            setAttrs({
                "bonus_parade_final": bonus_parade_final,
                "malus_esquive_final": malus_esquive_final
            });
        });
    });

    

</script>

<!-- JET DE DÉS -->
<script type="text/worker">
    on('clicked:roll-athletisme-force', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Athlétisme}} {{subheader=Force}} {{roll=[[0[resultat]]]}} {{stat=[[@{athletisme_force}[Compétence]-@{total_armures_malus_athletisme}[Malus Armure]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;

        // Calcul du degré de réussite ou d'échec
        const difference = computeObj.roll - des.result; // Différence entre la statistique ajustée et le jet de dés
        const degre = Math.floor(Math.abs(difference) / 10); // Un degré par palier de 10
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-athletisme-dex', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Athlétisme}} {{subheader=Dextérité}} {{roll=[[0[resultat]]]}} {{stat=[[@{athletisme_dexterite}[Compétence]-@{total_armures_malus_athletisme}[Armure - Malus Athlétisme]-@{total_armures_malus_demi_dexterite}[Armure - Malus Dextérité]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-baratin-charisme', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Baratin}} {{subheader=Charisme}} {{roll=[[0[resultat]]]}} {{stat=[[@{baratin_charisme}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-baratin-force', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Baratin}} {{subheader=Force}} {{roll=[[0[resultat]]]}} {{stat=[[@{baratin_force}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-bibliotheque', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Bibliothèque}} {{subheader=Intelligence}} {{roll=[[0[resultat]]]}} {{stat=[[@{bibliotheque}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-chercher', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Chercher}} {{subheader=Intelligence}} {{roll=[[0[resultat]]]}} {{stat=[[@{chercher}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-cac-dex', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Corps à corps}} {{subheader=Dextérité}} {{roll=[[0[resultat]]]}} {{stat=[[@{combat_cac_dexterite}[Compétence]-@{total_armures_malus_combat_cac}[Armure - Malus CaC]-@{total_armures_malus_demi_dexterite}[Armure - Malus Dextérité]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-cac-force', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Corps à corps}} {{subheader=Force}} {{roll=[[0[resultat]]]}} {{stat=[[@{combat_cac_force}[Compétence]-@{total_armures_malus_combat_cac}[Armure - Malus CaC]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-pugilat', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Pugilat}} {{subheader=Force}} {{roll=[[0[resultat]]]}} {{stat=[[@{combat_pugilat}[Compétence]-@{total_armures_malus_combat_pugilat}[Armure - Malus Pugilat]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-distance', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Distance}} {{subheader=Dextérité}} {{roll=[[0[resultat]]]}} {{stat=[[@{combat_distance}[Compétence]-@{total_armures_malus_combat_distance}[Armure - Malus CaC]-@{total_armures_malus_demi_dexterite}[Armure - Malus Dextérité]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_athletisme}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-discretion', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Discrétion}} {{subheader=Dextérité}} {{roll=[[0[resultat]]]}} {{stat=[[@{discretion}[Compétence]-@{total_armures_malus_discretion}[Armure - Malus Discrétion]-@{total_armures_malus_demi_dexterite}[Armure - Malus Dextérité]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_discretion}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-endurance', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Endurance}} {{subheader=Constitution}} {{roll=[[0[resultat]]]}} {{stat=[[@{endurance}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}}{{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-esquive', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Esquive}} {{subheader=Dextérité}} {{roll=[[0[resultat]]]}} {{stat=[[@{esquive}[Compétence]-@{total_armures_malus_esquive}[Armure - Malus Esquive]-@{total_boucliers_malus_esquive}[Bouclier - Malus Esquive]-@{total_armures_malus_demi_dexterite}[Armure - Malus Dextérité]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{malus_armure=@{total_armures_malus_discretion}}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-ancienne-intel', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Langue ancienne}} {{subheader=Intelligence}} {{roll=[[0[resultat]]]}} {{stat=[[@{langue_ancienne_intelligence}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})

    on('clicked:roll-ancienne-volonte', async (event) => {
		const roll = await startRoll("&{template:thanatos} {{jet=oui}} {{pnj=oui}} {{title=Langue ancienne}} {{subheader=Volonté}} {{roll=[[0[resultat]]]}} {{stat=[[@{langue_ancienne_volonte}[Compétence]]]}} {{des=[[1d100[Jet]]]}} {{mod=[[@{rollmodifier}[Modificateur]]]}} {{degre=[[0[resultat]]]}}"); 
		const {stat,des,mod,malus} = roll.results;
		const computeObj = {};
		computeObj.roll = mod.result + stat.result;
        const difference = computeObj.roll - des.result;
        const degre = Math.floor(Math.abs(difference) / 10);
        computeObj.degre = degre; 

	finishRoll(roll.rollId,computeObj);
	})
</script>
